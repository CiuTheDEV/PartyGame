:root{
--bg:#1a1a1a;
--text:#fff;
--brand1:#e91e63;
--brand2:#9b59b6;
--accent:var(--brand1);
--accent2:var(--brand2);
--accentA15:rgba(233,30,99,.15);
--accent2A15:rgba(155,89,182,.15);
--focusRing:0 0 0 2px var(--accent);
--btnShadow:0 8px 16px rgba(0,0,0,.35);
--btnShadowHover:0 9px 18px rgba(0,0,0,.40);
--btnLine:rgba(255,255,255,.10);
--btnInset:0 1px 0 rgba(255,255,255,.06) inset;
--danger:#e74c3c;
--dangerHover:#c0392b;
--success:#2ecc71;
--successA15:rgba(46,204,113,.15);
--rangeLabelW:170px;
--rangeBadgeW:64px;
--gearSize:clamp(46px,8vmin,60px);
--barH:60px;
--bottomBarH:60px;
--innerPad:clamp(10px,2.2vmin,18px);
--plGap:clamp(10px,2vmin,16px);
--plRadius:clamp(14px,2.2vmin,24px);
--plPad:clamp(10px,2vmin,14px);
--avFontP:clamp(2.2rem,6.5vmin,3.8rem);
--nameFontP:clamp(1.05rem,3vmin,1.65rem);
--scoreFont:clamp(1rem,2.6vmin,1.35rem);
--cellMin:clamp(140px,22vmin,230px);
--font-sans:'Segoe UI',Tahoma,sans-serif;
}
#globalSettingsOverlay,
#gameSettingsOverlay,
#rulesOverlay,
#emojiPickerOverlay{z-index:1300}
#confirmOverlay{z-index:1400}
#overlayGame .game-screen.bb-off { --bottomBarH: 0px; }
#overlayGame .game-screen.bb-off .bottom-bar { display: none; }
/* FLIP — zawartość karty (awers) */
/* FLIP — rewers jako overlay pseudo-element (zawsze istnieje, tylko zmienia opacity/rotację) */
:where(.players-bar,.stage1-grid) .player-pill::after{
content:"KALAMBURY";
position:absolute;
inset:0;
display:flex;
align-items:flex-end;
justify-content:center;
padding:14px 12px;
font-weight:1000;
letter-spacing:2px;
font-size:clamp(.8rem, calc(var(--cellMin) * .10), 1.2rem);
color:rgba(255,255,255,.18);
text-align:center;
text-transform:uppercase;
pointer-events:none;

background:
radial-gradient(120% 120% at 32% 22%, rgba(233,30,99,.16), transparent 62%),
radial-gradient(140% 140% at 70% 82%, rgba(155,89,182,.14), transparent 64%),
linear-gradient(135deg, rgba(8,8,8,.92), rgba(16,16,16,.88));

/* domyślnie: schowany (awers) */
opacity:0;
transform:rotateY(180deg);
transform-origin:center;
backface-visibility:hidden;
-webkit-backface-visibility:hidden;
transition:transform .42s cubic-bezier(.2,.9,.2,1), opacity .22s ease;
z-index:2;
}

/* podczas rewersu: pokazuj overlay i chowaj zawartość */
:where(.players-bar,.stage1-grid) .player-pill.is-facedown::after{
opacity:1;
transform:rotateY(0deg);
}

:where(.players-bar,.stage1-grid) .player-pill .pp-emoji,
:where(.players-bar,.stage1-grid) .player-pill .pp-meta,
:where(.players-bar,.stage1-grid) .player-pill .pp-name,
:where(.players-bar,.stage1-grid) .player-pill .pp-score{
transition:opacity .18s ease, transform .42s cubic-bezier(.2,.9,.2,1), filter .18s ease;
transform:rotateY(0deg);
backface-visibility:hidden;
-webkit-backface-visibility:hidden;
}

:where(.players-bar,.stage1-grid) .player-pill.is-facedown{
background:
radial-gradient(120% 120% at 32% 22%, rgba(233,30,99,.12), transparent 62%),
radial-gradient(140% 140% at 70% 82%, rgba(155,89,182,.10), transparent 64%),
linear-gradient(135deg,#1a1a1a,#0f0f0f);
border-color:rgba(255,255,255,.12);
}

:where(.players-bar,.stage1-grid) .player-pill.is-facedown .pp-emoji,
:where(.players-bar,.stage1-grid) .player-pill.is-facedown .pp-meta,
:where(.players-bar,.stage1-grid) .player-pill.is-facedown .pp-name,
:where(.players-bar,.stage1-grid) .player-pill.is-facedown .pp-score{
opacity:0;
transform:rotateY(-180deg) scale(.985);
filter:blur(10px);
}

/* badge zawsze nad rewersem */
/* ANCHOR: PLAYER_PILL_INTERACTIONS (plansza: mikro-interakcje) */
.players-bar .player-pill:active{transform:translateY(0) scale(.995)}

/* ANCHOR: GUESS_PICK_UI (wybór zgadującego po kliknięciu TAK) */
.players-bar.is-guess-pick .player-pill{cursor:pointer}
.players-bar.is-guess-pick .player-pill.guess-disabled{
opacity:.35;
filter:grayscale(1) brightness(.85);
cursor:not-allowed;
pointer-events:none;
transform:none;
border-color:rgba(255,255,255,.10);
}
.players-bar.is-guess-pick .player-pill:not(.guess-disabled):hover{
border-color:rgba(46,204,113,.65);
box-shadow:0 14px 28px rgba(0,0,0,.45), 0 0 0 3px rgba(46,204,113,.28);
filter:brightness(1.06);
transform:translateY(-1px);
}
.players-bar.is-guess-pick .player-pill:not(.guess-disabled):active{transform:translateY(0) scale(.995)}
/* ANCHOR: PRESENTER_CARD_NO_OVERLAP (prezenter nie nachodzi na kafle graczy) */
.player-pill.presenter-pill{
align-self:center;
margin-left:auto;
margin-right:auto;
margin-bottom:clamp(10px,2vmin,16px);

/* ANCHOR: PRESENTER_CARD_SQUARE (nie skaluje się do szerokości presenter_UI) */
width:min(var(--presenterCardSize), 100%);
aspect-ratio:1 / 1;
height:auto;
max-width:100%;
max-height:100%;

/* jak .roll-focus: avatar góra, nazwa dół */
grid-template-columns:1fr;
grid-template-rows:1fr auto;

/* cień trochę słabszy, żeby nie "wchodził" na siatkę graczy */
box-shadow:0 10px 18px rgba(0,0,0,.38), inset 0 1px 0 rgba(255,255,255,.06);
}
.player-pill.presenter-pill .pp-meta,
.player-pill.presenter-pill .pp-score{display:none}
.player-pill.presenter-pill .pp-emoji{
grid-column:1;
grid-row:1;
border-radius:calc(var(--plRadius) - 2px);
font-size:clamp(4.8rem,15vmin,7.8rem);
line-height:1;
/* ANCHOR: PRESENTER_AVATAR_NO_FRAME (bez ramki / bez cienia ramki) */
border:none;
box-shadow:none;
background:transparent;
will-change:transform;
}

/* ANCHOR: PRESENTER_AVATAR_PULSE (subtelny puls — respektuje motion-off) */
body:not(.motion-off) .player-pill.presenter-pill .pp-emoji{
animation:presenterAvatarPulse 1.65s ease-in-out infinite;
}
@keyframes presenterAvatarPulse{
0%,100%{ transform:scale(1); }
50%{ transform:scale(1.05); }
}
.player-pill.presenter-pill .pp-name{
grid-column:1;
grid-row:2;
text-transform:uppercase;
letter-spacing:1px;
}

/* lewa strefa — avatar (dominujący) */
/* prawa kolumna — 2 “pola” (nazwa + punkty) */
.players-bar.is-rolling .player-pill .pp-meta{display:contents}
.players-bar.is-rolling .player-pill .pp-score{display:none}
.players-bar.is-rolling .player-pill .pp-emoji{grid-column:1;grid-row:1;height:100%}
.players-bar.is-rolling .player-pill .pp-name{grid-column:1;grid-row:2}

/* ANCHOR: ROLL_FOCUS_PRESENTER_LAYOUT (podczas losowania: aktualna karta — większy avatar, bez pkt) */
.players-bar .player-pill.roll-focus{grid-template-columns:1fr;grid-template-rows:1fr auto}
.players-bar .player-pill.roll-focus .pp-meta{display:contents}
.players-bar .player-pill.roll-focus .pp-score{display:none}
.players-bar .player-pill.roll-focus .pp-emoji{grid-column:1;grid-row:1;height:100%;border-radius:calc(var(--plRadius) - 2px);font-size:clamp(3.2rem,10vmin,5.4rem)}
.players-bar .player-pill.roll-focus .pp-name{grid-column:1;grid-row:2;text-transform:uppercase;letter-spacing:1px}

/* ANCHOR: PLAYER_CARD_ROLL_STATES (podświetlenie wylosowanego prezentera) */
.player-pill.presenter-picked{
border-color:rgba(155,89,182,.65);
box-shadow:0 12px 22px rgba(0,0,0,.40), 0 0 0 3px var(--accent2);
transform:translateY(-1px);
filter:brightness(1.04);
z-index:1;
}
/* ANCHOR: PRESENTER_PICKED_AVATAR_BORDER_OFF (wylosowany prezenter: bez ramki na avatarze) */
.player-pill.presenter-picked .pp-emoji{
border:none;
box-shadow:none;
}

/* [PH] DEV: usunięto DEV_ONLY + DEV_STAGE_PILL (dev HUD jest w devhud.js) */
/* ANCHOR: GEAR_BTN (jak w Tajniakach) */
.gear-btn{
width:var(--gearSize);
height:var(--gearSize);
border-radius:14px;
border:1px solid rgba(255,255,255,.10);
background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));
color:#fff;
display:grid;
place-items:center;
cursor:pointer;
box-shadow:0 10px 18px rgba(0,0,0,.35);
transition:transform .14s, box-shadow .14s, filter .14s, background .14s;
padding:0;
}
.gear-btn:hover{filter:brightness(1.1);box-shadow:0 14px 26px rgba(0,0,0,.45)}
.gear-btn:active{transform:scale(.99)}

/* ANCHOR: GAME_SETTINGS_OVERLAY_UI (jak w Tajniakach — tylko: dźwięk + kontynuuj + powrót) */
#gameSettingsOverlay .settings-container{max-width:min(520px,92vw)}
.game-settings-actions{display:flex;flex-direction:column;gap:14px;margin-top:16px}
.game-settings-actions button{width:100%}
/* ANCHOR: RESUME_BTN_TOKEN (Kontynuuj jak Start — wspólny token przycisku potwierdzającego) */

/* ANCHOR: HOME_UI (IDENTYCZNY LAYOUT JAK TAJNIACY) */
.home-container{max-width:min(900px,90vw);width:90%}
.home-version{margin-top:14px;font-size:clamp(.75rem,1.6vmin,.95rem);color:#666;opacity:.85}

.home-title{
font-size:clamp(2.5rem,8vmin,5rem);
margin-bottom:2vh;
background:linear-gradient(135deg,#9b59b6,#e91e63);
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
animation:titlePulse 3s ease-in-out infinite;
filter:drop-shadow(0 0 24px rgba(233,30,99,0.45)) drop-shadow(0 0 52px rgba(155,89,182,0.32));
}

@keyframes titlePulse{
0%,100%{
transform:scale(1);
filter:drop-shadow(0 0 24px rgba(233,30,99,0.45)) drop-shadow(0 0 52px rgba(155,89,182,0.32));
}
50%{
transform:scale(1.02);
filter:drop-shadow(0 0 34px rgba(233,30,99,0.6)) drop-shadow(0 0 76px rgba(155,89,182,0.45));
}
}

/* ANCHOR: MODE_CARDS_UI (ROZWIJANE KARTY JAK W TAJNIACY / 5 SEKUND) */
.mode-selection{display:flex;flex-direction:column;gap:clamp(10px,2vmin,20px);margin-bottom:3vh}

.mode-card{
background:linear-gradient(135deg,#2a2a2a,#1a1a1a);
border-radius:clamp(12px,2vmin,20px);
transition:all .3s;
border:2px solid transparent;
overflow:hidden;
}
.mode-card:hover{box-shadow:0 5px 20px rgba(0,0,0,.4)}

.mode-card.classic{border-color:var(--accent)}
.mode-card.wip{border-color:#9E9E9E}

.mode-header{display:flex;align-items:center;padding:clamp(12px,2.5vmin,25px) clamp(15px,3vmin,30px);position:relative;cursor:pointer}
.mode-icon{font-size:clamp(2rem,5vmin,3.5rem);position:absolute;left:clamp(15px,3vmin,30px)}
.mode-title-wrapper{flex:1;display:flex;align-items:center;justify-content:center;gap:clamp(8px,1.5vmin,15px)}
.mode-title{font-size:clamp(1.3rem,3.5vmin,2.2rem);font-weight:bold}

.mode-card.classic .mode-title{color:var(--accent)}
.mode-card.wip .mode-title{color:#9E9E9E}

.mode-wip-badge{
background:#9E9E9E;
color:#1a1a1a;
font-size:clamp(0.6rem,1.5vmin,0.8rem);
font-weight:bold;
padding:clamp(3px,0.5vmin,5px) clamp(8px,1.2vmin,12px);
border-radius:clamp(4px,0.8vmin,8px);
text-transform:uppercase;
letter-spacing:1px;
}

.mode-arrow{position:absolute;right:clamp(15px,3vmin,30px);font-size:clamp(0.8rem,2vmin,1.2rem);color:#666;transition:transform .3s ease}
.mode-card.open .mode-arrow{transform:rotate(180deg)}

.mode-content{max-height:0;overflow:hidden;transition:max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1);border-top:1px solid transparent}
.mode-card.open .mode-content{max-height:500px;border-top-color:#333}

.mode-content-inner{display:flex;flex-direction:row;align-items:flex-end;justify-content:space-between;gap:clamp(15px,3vmin,25px);padding:clamp(12px,2vmin,20px) clamp(15px,3vmin,30px);background:rgba(0,0,0,0.2)}

.mode-details{flex:1;min-width:0;opacity:0;transform:translateY(-10px);transition:opacity 0.4s ease 0.15s, transform 0.4s ease 0.15s;text-align:left}
.mode-card.open .mode-details{opacity:1;transform:translateY(0)}

.mode-description{font-size:clamp(0.9rem,2vmin,1.1rem);color:#aaa;margin-bottom:clamp(6px,1vmin,10px)}

.mode-features{text-align:left;font-size:clamp(0.8rem,1.8vmin,1rem);color:#888;list-style:none;padding:0;margin:0}
.mode-features li{margin:clamp(2px,0.5vmin,5px) 0;padding-left:1em;position:relative}
.mode-features li::before{content:'•';position:absolute;left:0;color:#666}

.mode-buttons{display:flex;gap:clamp(8px,1.5vmin,12px);flex-shrink:0;align-self:flex-end;opacity:0;transform:translateX(10px);transition:opacity 0.4s ease 0.2s, transform 0.4s ease 0.2s}
.mode-card.open .mode-buttons{opacity:1;transform:translateX(0)}

.mode-btn{
width:clamp(40px,7vmin,55px);
height:clamp(40px,7vmin,55px);
border-radius:50%;
border:2px solid #666;
background:rgba(0,0,0,0.3);
color:#aaa;
font-size:clamp(1.1rem,2.5vmin,1.5rem);
font-weight:bold;
cursor:pointer;
transition:all .2s;
display:grid;
place-items:center;
padding:0;
line-height:1;
}

/* ANCHOR: PLAY_TRIANGLE (grubszy niż emotka, idealnie wycentrowany) */
.mode-btn.play{--triH:clamp(9px,2.2vmin,12px);--triW:clamp(14px,3vmin,18px)}
.mode-btn.play .play-tri{width:var(--triW);height:calc(var(--triH) * 2);background:currentColor;clip-path:polygon(0 0, 0 100%, 100% 50%)}

.mode-btn.info{font-style:italic;font-family:Georgia,'Times New Roman',serif}
.mode-btn:hover{background:rgba(255,255,255,0.1);border-color:#aaa;color:#fff;transform:scale(1.06)}

.mode-card.classic .mode-btn.play{border-color:var(--accent);color:var(--accent)}
.mode-card.classic .mode-btn.play:hover{background:var(--accent);color:#fff}

.mode-btn.disabled,
.mode-btn[disabled]{opacity:0.4;cursor:not-allowed}
.mode-btn.disabled:hover,
.mode-btn[disabled]:hover{transform:none;background:rgba(0,0,0,0.3);border-color:#666;color:#aaa}

/* ANCHOR: HOME_BOTTOM_BUTTONS (JAK W TAJNIACY) */
.home-bottom-buttons{display:flex;gap:clamp(10px,2vmin,20px);margin-top:clamp(20px,4vmin,40px);flex-wrap:wrap;justify-content:center}

.home-btn{
background:transparent;
border:2px solid;
padding:clamp(10px,1.8vmin,16px) clamp(18px,3vmin,30px);
font-size:clamp(0.85rem,2.2vmin,1.1rem);
border-radius:clamp(8px,1.2vmin,12px);
cursor:pointer;
transition:all .2s;
font-weight:500;
}
.home-btn:hover{transform:scale(1.03)}

.home-btn.hub-btn{border-color:#888;color:#888}
.home-btn.hub-btn:hover{background:#888;color:#fff}
.home-btn.settings-btn{border-color:#3498db;color:#3498db}
.home-btn.settings-btn:hover{background:#3498db;color:#fff}
/* [PH] MOVED_TO_CORE: RULES_UI */
/* [PH] MOVED_TO_CORE: MODE_SETTINGS_UI */
/* [PH] MOVED_TO_CORE: SCROLL_SURFACE */
/* [PH] MOVED_TO_CORE: UTIL_LAYOUT */
/* [PH] MOVED_TO_CORE: EMOJI_PICKER_UTIL */
/* [PH] MOVED_TO_CORE: MODE_SETTINGS_CARDS */
/* [PH] MOVED_TO_CORE: ROUND_RANGE_UI */
/* [PH] MOVED_TO_CORE: CATEGORIES_UI */
/* [PH] MOVED_TO_CORE: PLAYERS_UI */
/* [PH] MOVED_TO_CORE: EMOJI_PICKER_LAYOUT */
/* [PH] MOVED_TO_CORE: EMOJI_PICKER_FIXED_HEIGHT */
/* [PH] MOVED_TO_CORE: EMOJI_GRID_SCROLLFIX */
/* [PH] MOVED_TO_CORE: TOGGLE_SWITCH */
/* [PH] MOVED_TO_CORE: BUTTONS */
/* [PH] MOVED_TO_CORE: BUTTONS_POLISH */
/* [PH] MOVED_TO_CORE: CONFIRM_BTN_HOVER_BRIGHTNESS */
/* [PH] MOVED_TO_CORE: BTN_BACK */
/* [PH] MOVED_TO_CORE: FOCUS_VISIBLE */
/* [PH] MOVED_TO_CORE: TWEMOJI */
/* [PH] MOVED_TO_CORE: A11Y_REDUCED_MOTION */
/* [PH] MOVED_TO_CORE: RANGE_THUMB */

/* [PH] MOVED_TO_CORE: GAME_SHELL (game-screen + game-hud + stage base) */
/* ANCHOR: STAGE_1_UI (Losowanie — karty graczy rewersem) */
#overlayGame .stage.stage-1{align-items:stretch;justify-content:stretch}
#overlayGame .stage.stage-1 .stage-card{width:100%;height:100%;max-width:none;justify-content:flex-start;gap:clamp(10px,2vmin,16px)}
#overlayGame .stage1-head{display:flex;flex-direction:column;align-items:center;gap:clamp(6px,1.2vmin,10px)}
#overlayGame .stage1-grid{
position:relative;
width:min(980px,94vw);
flex:1;
min-height:0;
margin:0 auto;
padding:var(--innerPad);
border-radius:clamp(16px,2.2vmin,24px);
background:rgba(0,0,0,.18);
border:1px solid rgba(255,255,255,.10);
box-shadow:inset 0 1px 0 rgba(255,255,255,.05);
--cols:4;
--rows:2;
display:grid;
gap:var(--plGap);
grid-template-columns:repeat(var(--cols), minmax(0, 1fr));
grid-template-rows:repeat(var(--rows), minmax(0, 1fr));
place-content:center;
align-content:center;
justify-content:center;
}
/* [PH] STAGE1_BORDER_PROGRESS (wariant A — zapełnianie obramówki) */
#overlayGame .stage1-grid::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;
  opacity:0;
  transition:opacity .18s ease;

  /* Minimalistyczny progress: cienka ramka, bez "koła" w środku */
  --bw:clamp(2px,.35vmin,3px);
  /* start od godziny 12 (0deg w CSS conic-gradient) */
  padding:var(--bw);
  background:conic-gradient(from 0deg,
    var(--accent2) 0turn,
    var(--accent) calc(var(--p,0) * 1turn),
    transparent calc(var(--p,0) * 1turn),
    transparent 1turn
  );

  /* Zostawiamy tylko obwódkę (content-box wycięty) */
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
          mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
          mask-composite:exclude;
}
#overlayGame .stage1-grid.is-advancing::before{opacity:1}

#overlayGame .stage1-grid .player-pill{min-width:0;min-height:0}

/* ANCHOR: STAGE1_DECK_MODE (na start: karty leżą na sobie rewersem) */
#overlayGame .stage1-grid.is-deck{
display:block;
position:relative;
}
#overlayGame .stage1-grid.is-deck .player-pill{
position:absolute;
left:50%;
top:50%;
width:clamp(160px, 26vmin, 240px);
height:clamp(160px, 26vmin, 240px);
transform:translate(-50%, -50%) rotate(var(--deckRot, 0deg)) translate(var(--deckX, 0px), var(--deckY, 0px));
transform-origin:center;
pointer-events:none;
box-shadow:0 18px 34px rgba(0,0,0,.55), inset 0 1px 0 rgba(255,255,255,.06);
}
#overlayGame .stage1-grid.is-deck .player-pill:nth-child(1){--deckRot:-7deg;--deckX:-8px;--deckY:10px}
#overlayGame .stage1-grid.is-deck .player-pill:nth-child(2){--deckRot:6deg;--deckX:10px;--deckY:4px}
#overlayGame .stage1-grid.is-deck .player-pill:nth-child(3){--deckRot:-4deg;--deckX:-4px;--deckY:-6px}
#overlayGame .stage1-grid.is-deck .player-pill:nth-child(4){--deckRot:3deg;--deckX:6px;--deckY:-10px}
#overlayGame .stage1-grid.is-deck .player-pill:nth-child(5){--deckRot:-2deg;--deckX:-10px;--deckY:0px}
#overlayGame .stage1-grid.is-deck .player-pill:nth-child(6){--deckRot:2deg;--deckX:8px;--deckY:8px}
#overlayGame .stage1-grid.is-deck .player-pill:nth-child(7){--deckRot:-1deg;--deckX:-2px;--deckY:-12px}
#overlayGame .stage1-grid.is-deck .player-pill:nth-child(8){--deckRot:1deg;--deckX:2px;--deckY:12px}

/* ANCHOR: STAGE1_ROLL_FOCUS (skakanie hovera po kartach) */
#overlayGame .stage1-grid.is-rolling{pointer-events:none}

/* motyw gry (accent/gradient) — spójne z Kalamburami */
#overlayGame .stage1-grid .player-pill.roll-focus{
border-color:rgba(233,30,99,.92);
box-shadow:
0 18px 34px rgba(0,0,0,.55),
0 0 0 4px rgba(233,30,99,.28),
0 0 34px rgba(233,30,99,.26),
0 0 28px rgba(155,89,182,.24);
filter:brightness(1.12) saturate(1.12);
transform:translateY(-2px) scale(1.02);
z-index:2;
}

/* ANCHOR: STAGE1_ROLL_FOCUS_PULSE (puls w trakcie losowania — respektuje motion-off) */
body:not(.motion-off) #overlayGame .stage1-grid .player-pill.roll-focus{
animation:stage1RollPulse .85s ease-in-out infinite;
}
@keyframes stage1RollPulse{
0%,100%{
box-shadow:
0 18px 34px rgba(0,0,0,.55),
0 0 0 4px rgba(233,30,99,.26),
0 0 30px rgba(155,89,182,.22),
0 0 24px rgba(233,30,99,.22);
}
50%{
box-shadow:
0 18px 34px rgba(0,0,0,.55),
0 0 0 4px rgba(155,89,182,.24),
0 0 30px rgba(233,30,99,.26),
0 0 24px rgba(155,89,182,.22);
}
}

/* ANCHOR: STAGE1_PICKED_LAYOUT (wylosowana karta: tylko avatar + nazwa pod spodem) */
#overlayGame .stage1-grid .player-pill.stage1-picked{
grid-template-columns:1fr;
grid-template-rows:1fr auto;
}
#overlayGame .stage1-grid .player-pill.stage1-picked .pp-meta{display:contents}
#overlayGame .stage1-grid .player-pill.stage1-picked .pp-score{display:none}
#overlayGame .stage1-grid .player-pill.stage1-picked .pp-emoji{
grid-column:1;
grid-row:1;
height:100%;
border-radius:calc(var(--plRadius) - 2px);
font-size:clamp(3.9rem,12vmin,6.6rem);
}
#overlayGame .stage1-grid .player-pill.stage1-picked .pp-name{
grid-column:1;
grid-row:2;
text-transform:uppercase;
letter-spacing:1px;
}

/* ANCHOR: STAGE1_ORDER_BADGE (numer kolejności na rewersie) */
#overlayGame .pp-order{
position:absolute;
top:clamp(6px,1.2vmin,10px);
right:clamp(6px,1.2vmin,10px);
width:clamp(26px,4.6vmin,40px);
height:clamp(26px,4.6vmin,40px);
border-radius:999px;
display:grid;
place-items:center;
font-weight:1000;
font-size:clamp(.85rem,2.6vmin,1.2rem);
letter-spacing:.5px;
background:linear-gradient(135deg, rgba(155,89,182,.26), rgba(233,30,99,.18));
border:1px solid rgba(233,30,99,.55);
box-shadow:0 10px 18px rgba(0,0,0,.45), 0 0 18px rgba(233,30,99,.12);
z-index:3;
user-select:none;
pointer-events:none;
}
#overlayGame .pp-order.is-hidden{display:none}

/* ANCHOR: BOTTOM_BAR_ACTIONS (2 przyciski w dolnym barze) */
#overlayGame .bottom-bar .bb-actions{
width:min(980px,94vw);
display:flex;
align-items:center;
justify-content:center;
gap:clamp(10px,2vmin,16px);
}
#overlayGame .bottom-bar .bb-actions button{
  display:inline-block;
  width:auto;
max-width:none;
padding:clamp(12px,2.2vmin,18px) clamp(16px,3vmin,28px);
font-size:clamp(1.05rem,2.8vmin,1.35rem);
line-height:1;
}
#overlayGame .bottom-bar .bb-actions .bb-side{flex:1;min-width:0}
#overlayGame .bottom-bar .bb-actions .bb-main{flex:2;min-width:0}

/* ANCHOR: STAGE_2_UI (Start rundy — pokazuje kolejność + aktualnego prezentera) */
#overlayGame .stage.stage-2{align-items:stretch;justify-content:stretch}
#overlayGame .stage.stage-2 .stage-card{width:100%;height:100%;max-width:none;justify-content:flex-start;gap:clamp(10px,2vmin,16px)}
#overlayGame .stage2-head{
display:flex;
flex-direction:column;
align-items:center;
gap:clamp(6px,1.2vmin,10px);
  display:inline-block;
  width:auto;
flex:1;
min-height:0;
}
#overlayGame .stage2-sub{
font-weight:1000;
letter-spacing:1.2px;
text-transform:uppercase;
font-size:clamp(.92rem,2.4vmin,1.15rem);
opacity:.78;
}

/* ANCHOR: TOP_BAR_META (info rundy w TOP_BAR podczas STAGE 2) */
#overlayGame .top-stage-meta{
grid-column:1;
justify-self:start;
align-self:center;
display:flex;
flex-wrap:nowrap;
align-items:center;
justify-content:flex-start;
gap:clamp(8px,1.6vmin,12px);
min-width:0;
max-width:100%;
overflow-x:auto;
overflow-y:hidden;
padding-right:clamp(6px,1.2vmin,10px);
scrollbar-width:none;
user-select:none;
}
#overlayGame .top-stage-meta::-webkit-scrollbar{display:none}

#overlayGame .stage2-chip{
display:inline-flex;
align-items:center;
justify-content:center;
gap:clamp(8px,1.6vmin,10px);
padding:clamp(5px,1.05vmin,8px) clamp(8px,1.7vmin,12px);
border-radius:999px;
border:1px solid rgba(255,255,255,.12);
background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));
box-shadow:0 10px 18px rgba(0,0,0,.28);
min-width:0;
max-width:100%;
}
#overlayGame .stage2-chip .k{
font-weight:1000;
letter-spacing:1px;
text-transform:uppercase;
font-size:clamp(.62rem,1.55vmin,.82rem);
color:rgba(255,255,255,.62);
white-space:nowrap;
flex:0 0 auto;
}
#overlayGame .stage2-chip .v{
font-weight:1000;
letter-spacing:.6px;
text-transform:uppercase;
font-size:clamp(.74rem,1.75vmin,.95rem);
background:linear-gradient(135deg, var(--accent2), var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
white-space:nowrap;
overflow:hidden;
text-overflow:ellipsis;
min-width:0;
max-width:min(26vw, 280px);
filter:drop-shadow(0 0 12px rgba(233,30,99,.14));
}
#overlayGame .stage2-presenter{
position:relative;
margin-top:clamp(6px,1.2vmin,10px);

/* ANCHOR: STAGE2_PRESENTER_SQUARE_CLOSED
Gdy szuflada graczy jest ZAMKNIĘTA: prezenter ma być DUŻY i KWADRATOWY.
(Rozmiar oparty o vmin, żeby dobrze wyglądało na TV i nie wychodziło poza HUD.) */
width:500px;
height:618px;
max-width:100%;
max-height:100%;
aspect-ratio:auto;

display:grid;
place-items:center;
padding:clamp(6px,1.2vmin,10px);

flex:1;
min-height:0;

/* ANCHOR: STAGE2_PRESENTER_SCALE_WITH_SHEET */
transform:translateY(0) scale(1);
transform-origin:center top;
transition:
transform .42s cubic-bezier(.2,.9,.2,1),
opacity  .42s cubic-bezier(.2,.9,.2,1),
filter   .42s cubic-bezier(.2,.9,.2,1);
}

/* W STAGE 2: karta prezentera wypełnia kwadrat .stage2-presenter */
#overlayGame .stage.stage-2 .stage2-presenter .player-pill.presenter-pill{
  /* [PH] Stage 2: zachowaj GRID (emoji + nazwa), bo display:block ucina nazwę przez overflow */
  display:grid;
  grid-template-columns:1fr;
  grid-template-rows:1fr auto;

  width:100%;
  height:100%;
  max-width:none;
  max-height:none;
  margin:0;
  align-self:stretch;
  justify-self:stretch;
  aspect-ratio:auto;
}
#overlayGame .stage.stage-2 .stage2-presenter .player-pill.presenter-pill .pp-emoji{
/* większy avatar w Stage 2 (na TV) */
font-size:clamp(6.2rem, 22vmin, 10rem);
}
#overlayGame .stage.stage-2 .stage2-presenter .player-pill.presenter-pill .pp-name{
font-size:clamp(1.15rem,3.4vmin,1.9rem);
}

/* ANCHOR: STAGE2_PRESENTER_LABEL (nad kartą prezentera — w kolorystyce gry) */
#overlayGame .stage2-presenter-label{
position:absolute;
top:clamp(6px,1.2vmin,12px);
left:50%;
transform:translateX(-50%);
font-weight:1000;
letter-spacing:2px;
text-transform:uppercase;
font-size:clamp(1rem,3vmin,1.4rem);
background:linear-gradient(135deg, var(--accent2), var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
filter:drop-shadow(0 0 14px rgba(233,30,99,.18));
pointer-events:none;
user-select:none;
z-index:2;
}
/* (opcjonalnie) gdy sheet otwarty — prezenter i tak jest chowamy, ale zmniejszamy bazę dla płynniejszego przejścia */
#overlayGame .stage.stage-2 .stage-card.stage2-sheet-open .stage2-presenter{
width:360px;
height:360px;
max-width:100%;
max-height:100%;
}

/* gdy szuflada graczy jest otwarta — chowaj cały blok prezentera (sheet przykrywa cały HUD) */
#overlayGame .stage.stage-2 .stage-card.stage2-sheet-open .stage2-head{
opacity:0;
transform:translateY(-8px) scale(.985);
filter:blur(10px);
pointer-events:none;
}
#overlayGame .stage2-grid{
width:min(980px,94vw);
flex:1;
min-height:0;
margin:0 auto;
padding:var(--innerPad);
border-radius:clamp(16px,2.2vmin,24px);
background:rgba(0,0,0,.18);
border:1px solid rgba(255,255,255,.10);
box-shadow:inset 0 1px 0 rgba(255,255,255,.05);
--cols:4;
--rows:2;
display:grid;
gap:var(--plGap);
grid-template-columns:repeat(var(--cols), minmax(0, 1fr));
grid-template-rows:repeat(var(--rows), minmax(0, 1fr));
place-content:center;
align-content:center;
justify-content:center;
}
#overlayGame .stage2-grid .player-pill{min-width:0;min-height:0}
/* ANCHOR: STAGE2_SHEET (nowoczesna szuflada z dołu — pulsująca strzałka ^)
WYMAGANIE: po otwarciu karty graczy mają przykryć CAŁY GAME_HUD, chowając .stage2-presenter.
*/
#overlayGame .stage.stage-2 .stage-card{
position:relative;
overflow:hidden;

/* tokeny szuflady */
--sheetPeek: clamp(48px, 7vmin, 66px);
--sheetRadius: clamp(18px, 2.4vmin, 26px);

/* zostaw miejsce na „peek” u dołu, żeby nie nachodziło na prezentera gdy zamknięte */
padding:clamp(16px,2.8vmin,26px);
padding-bottom:calc(clamp(16px,2.8vmin,26px) + var(--sheetPeek));
box-sizing:border-box;
}

/* szuflada pełnoekranowa (cover HUD) — wysuwa się z dołu */
#overlayGame .stage2-sheet{
position:absolute;
inset:0;
  display:inline-block;
  width:auto;
height:100%;
z-index:10;

transform:translateY(calc(100% - var(--sheetPeek)));
transition:transform .42s cubic-bezier(.2,.9,.2,1);

border-radius:var(--sheetRadius);
border:1px solid rgba(255,255,255,.12);
background:
radial-gradient(120% 120% at 18% 14%, rgba(233,30,99,.14), transparent 60%),
radial-gradient(120% 120% at 82% 86%, rgba(155,89,182,.12), transparent 62%),
linear-gradient(180deg, rgba(0,0,0,.48), rgba(0,0,0,.78));
box-shadow:0 -18px 34px rgba(0,0,0,.55);
backdrop-filter:blur(10px);
-webkit-backdrop-filter:blur(10px);

display:flex;
flex-direction:column;
overflow:hidden;
}
#overlayGame .stage2-sheet.is-open{transform:translateY(0)}

/* stary selektor (w razie gdyby coś jeszcze go używało) */
#overlayGame .stage2-drawer{all:unset}

/* uchwyt + caret (na górze sheet; gdy sheet zamknięty, uchwyt jest widoczny na dole HUD) */
#overlayGame .stage2-sheet-handle{
height:var(--sheetPeek);
  display:inline-block;
  width:auto;
padding:0;
border:0;
background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));
color:#fff;
cursor:pointer;
position:relative;
display:flex;
align-items:center;
justify-content:center;
}
#overlayGame .stage2-sheet-handle:hover{filter:brightness(1.08)}
#overlayGame .stage2-sheet-handle:active{transform:scale(.995)}

/* „grab handle” — delikatna kreska */
#overlayGame .stage2-sheet-handle::before{
content:"";
position:absolute;
left:50%;
top:50%;
transform:translate(-50%,-50%);
width:clamp(72px, 16vmin, 140px);
height:6px;
border-radius:999px;
background:rgba(255,255,255,.12);
box-shadow:inset 0 1px 0 rgba(255,255,255,.10);
opacity:.55;
}

/* pulsująca strzałka ^ */
#overlayGame .stage2-sheet-caret{
position:relative;
z-index:1;
font-weight:1000;
font-size:clamp(1.4rem,4.2vmin,2.2rem);
opacity:.92;
transform:translateY(-3px);
transition:transform .22s ease, opacity .22s ease, filter .22s ease;
filter:drop-shadow(0 12px 18px rgba(0,0,0,.38));
}
#overlayGame .stage2-sheet.is-open .stage2-sheet-caret{
transform:translateY(3px) rotate(180deg);
opacity:.96;
}

/* hint pulse tylko gdy zamknięte i motion ON */
body:not(.motion-off) #overlayGame .stage2-sheet:not(.is-open) .stage2-sheet-caret{
animation:stage2CaretPulse 1.15s ease-in-out infinite;
}
@keyframes stage2CaretPulse{
0%,100%{
transform:translateY(-3px) scale(1);
opacity:.86;
filter:drop-shadow(0 12px 18px rgba(0,0,0,.38));
}
50%{
transform:translateY(-10px) scale(1.06);
opacity:1;
filter:
drop-shadow(0 0 18px rgba(233,30,99,.26))
drop-shadow(0 12px 18px rgba(0,0,0,.38));
}
}

/* zawartość szuflady */
#overlayGame .stage2-sheet-body{
flex:1;
min-height:0;
padding:var(--innerPad);
padding-top:clamp(10px,2vmin,14px);
overflow:auto;
scrollbar-width:thin;
scrollbar-color:var(--accent) rgba(0,0,0,.0);
}
#overlayGame .stage2-sheet:not(.is-open) .stage2-sheet-body{
opacity:0;
pointer-events:none;
}

/* w środku: grid graczy (bez zmian układu) */
#overlayGame .stage2-sheet .stage2-grid{width:100%}
/* [PH] MOVED_TO_CORE: TOP_BOTTOM_BARS */
/* ANCHOR: TOP_BAR_STAGE_TITLE (tytuł etapu: LOSOWANIE / PREZENTUJE) */
/* [PH] MOVED_TO_CORE: TOP_BOTTOM_BARS */
/* w dev: pokazujemy przełącznik stage, a nie tytuł */

#overlayGame .top-bar-inner .gear-btn{grid-column:3;justify-self:end}    /* ANCHOR: PRESENTER_SLOT_BASE (czysta plansza — wrapper rzędu 2) */
#overlayGame .presenter-slot{
grid-row:2;
min-height:0;
padding:clamp(8px,1.8vmin,14px) clamp(12px,2.4vmin,18px);
display:flex;
align-items:center;
justify-content:center;
}

/* ANCHOR: PRESENTER_UI_WRAP (centrowanie + brak wychodzenia poza PRESENTER_UI) */
#overlayGame .presenter-ui{
width:min(60%, var(--presenterTileW));
margin:0 auto;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
gap:clamp(10px,2vmin,16px);
overflow:hidden;
min-width:0;
box-sizing:border-box;
padding-inline:clamp(4px,1vmin,10px);
}

/* ANCHOR: PRESENTER_TITLE_BRAND (napis "Prezentuje" — większy + styl jak liczba w turn_timer) */
#overlayGame .presenter-title{
font-weight:1000;
letter-spacing:2px;
text-transform:uppercase;
font-size:clamp(1.6rem,5.2vmin,2.8rem);
line-height:1;
user-select:none;

/* styl jak .countdown-num (gradient text) */
background:linear-gradient(135deg, var(--accent2), var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
filter:drop-shadow(0 0 16px rgba(233,30,99,.22));
text-shadow:0 2px 10px rgba(0,0,0,.55);
}

/* ANCHOR: PRESENTER_SLOT_EMPTY_COLLAPSE (przed losowaniem kolejności) */
#overlayGame .presenter-slot.is-empty{display:none}

/* BOTTOM BAR buttons visibility */
.btn-show-password.is-hidden,.presenter-draw-btn.is-hidden{display:none !important}

/* BOTTOM BAR button sizing */
#overlayGame .bottom-bar .presenter-draw-btn,
#overlayGame .bottom-bar .btn-show-password,
#overlayGame .bottom-bar .btn-roll-order{
width:min(520px,94vw);
max-width:100%;
padding:clamp(12px,2.2vmin,18px) clamp(16px,3vmin,28px);
font-size:clamp(1.05rem,2.8vmin,1.35rem);
line-height:1;
}
/* [PH] MOVED_TO_CORE: TOP_BOTTOM_BARS */
/* BOTTOM BAR */
/* [PH] MOVED_TO_CORE: TOP_BOTTOM_BARS */
/* ANCHOR: COUNTDOWN_AND_REVEAL_UI */
/* Wspólny kafelek pod prezenterem (reveal / countdown / turn_timer) */
:root{
--presenterTileW:min(560px,92vw);
--presenterTileH:clamp(250px,34vmin,380px);

/* ANCHOR: PRESENTER_CARD_SIZE (bardziej kwadratowa karta prezentera) */
--presenterCardSize:clamp(158px,19.5vmin,245px);
--presenterCardW:min(var(--presenterCardSize),92vw);
}

.countdown-wrap,
.reveal-wrap{
width:var(--presenterTileW);
height:var(--presenterTileH);
margin:clamp(10px,2vmin,16px) auto 0;
border-radius:clamp(14px,2vmin,22px);
border:1px solid rgba(255,255,255,.12);
background:linear-gradient(135deg, rgba(233,30,99,.12), rgba(155,89,182,.14));
box-shadow:0 18px 34px rgba(0,0,0,.50);
padding:clamp(14px,2.4vmin,22px) clamp(16px,2.8vmin,26px);
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
gap:clamp(8px,1.6vmin,12px);
user-select:none;
text-align:center;
}

/* reveal ma dodatkowy odstęp na elementy */
.reveal-wrap{gap:clamp(8px,1.6vmin,12px)}

/* ANCHOR: COUNTDOWN_TYPO (Countdown + Turn Timer — przywrócone ustawienia czcionek) */
.countdown-lead{
font-weight:1000;
letter-spacing:1px;
text-transform:uppercase;
font-size:clamp(1.05rem,3.1vmin,1.45rem);
opacity:.92;
text-shadow:0 2px 10px rgba(0,0,0,.55);
}
.countdown-num{
font-weight:1000;
font-size:clamp(4.2rem,14vmin,7.6rem);
line-height:1;
letter-spacing:1px;
font-variant-numeric:tabular-nums;
background:linear-gradient(135deg, var(--accent2), var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
filter:drop-shadow(0 0 16px rgba(233,30,99,.22));
}
.countdown-tip{
max-width:min(64ch, 92%);
font-weight:850;
font-size:clamp(.95rem,2.4vmin,1.2rem);
line-height:1.25;
opacity:.78;
text-shadow:0 2px 10px rgba(0,0,0,.55);
}
#turnTimerWrap .countdown-tip{opacity:.85;letter-spacing:.4px}

/* ANCHOR: TURN_TIMER_TYPO_OVERRIDES (większe napisy w kafelku timera tury) */
#turnTimerWrap .countdown-lead{
font-size:clamp(1.25rem,3.8vmin,1.85rem);
letter-spacing:1.4px;
}
#turnTimerWrap .countdown-num{
font-size:clamp(4.8rem,16vmin,8.4rem);
}
#turnTimerWrap .countdown-tip{
font-size:clamp(1.05rem,2.9vmin,1.35rem);
opacity:.88;
}

.reveal-wrap{
width:min(560px,92vw);
margin:clamp(10px,2vmin,16px) auto 0;
border-radius:clamp(14px,2vmin,22px);
border:1px solid rgba(255,255,255,.12);
background:linear-gradient(135deg, rgba(233,30,99,.12), rgba(155,89,182,.14));
box-shadow:0 18px 34px rgba(0,0,0,.50);
padding:clamp(14px,2.4vmin,22px) clamp(16px,2.8vmin,26px);
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
gap:clamp(8px,1.6vmin,12px);
user-select:none;
text-align:center;
}
.reveal-player{
font-weight:1000;
font-size:clamp(1.2rem,3.6vmin,1.8rem);
opacity:.95;
text-transform:uppercase;
letter-spacing:1px;
}
/* ANCHOR: REVEAL_TIMER_UI (czas widoczności hasła) */
.reveal-timer{
display:flex;
align-items:baseline;
justify-content:center;
gap:8px;
margin-top:-2px;
user-select:none;
text-transform:uppercase;
letter-spacing:1px;
font-weight:1000;
opacity:.88;
}
.reveal-timer-label{font-size:clamp(.85rem,2.35vmin,1.05rem)}
.reveal-timer-num{
font-size:clamp(1.15rem,3.8vmin,1.85rem);
line-height:1;
background:linear-gradient(135deg, var(--accent2), var(--accent));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
filter:drop-shadow(0 0 14px rgba(233,30,99,.20));
}
.reveal-timer-unit{font-size:clamp(.85rem,2.35vmin,1.05rem);opacity:.85}

.reveal-lead{opacity:.85;font-weight:900;letter-spacing:.4px}
.reveal-word{
font-weight:1000;
font-size:clamp(2.1rem,6.8vmin,4.1rem);
line-height:1.02;
padding:clamp(8px,1.6vmin,12px) clamp(12px,2.2vmin,18px);
border-radius:clamp(12px,1.8vmin,18px);
background:rgba(0,0,0,.22);
border:1px solid rgba(255,255,255,.12);
box-shadow:inset 0 1px 0 rgba(255,255,255,.06);
letter-spacing:.6px;
}
.reveal-cat{opacity:.75;font-weight:900;text-transform:uppercase;letter-spacing:1px;font-size:clamp(.85rem,2.4vmin,1.05rem)}
.reveal-catname{
font-weight:1000;
font-size:clamp(1.05rem,3.2vmin,1.45rem);
background:linear-gradient(135deg, var(--accent), var(--accent2));
-webkit-background-clip:text;
-webkit-text-fill-color:transparent;
background-clip:text;
filter:drop-shadow(0 0 12px rgba(155,89,182,.22));
}

/* ANCHOR: JUDGE_UI (po końcu tury: pytanie TAK/NIE pod prezenterem) */
.judge-wrap{
width:min(520px,92vw);
margin:clamp(10px,2vmin,16px) auto 0;
border-radius:clamp(14px,2vmin,22px);
border:1px solid rgba(255,255,255,.12);
background:linear-gradient(135deg, rgba(155,89,182,.16), rgba(233,30,99,.10));
box-shadow:0 16px 30px rgba(0,0,0,.48);
padding:clamp(14px,2.4vmin,22px) clamp(16px,2.8vmin,26px);
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
gap:clamp(10px,2vmin,14px);
user-select:none;
text-align:center;
}
.judge-title{
font-weight:1000;
letter-spacing:1px;
text-transform:uppercase;
font-size:clamp(1.05rem,3vmin,1.35rem);
opacity:.95;
}
.judge-actions{
  display:inline-block;
  width:auto;
display:flex;
gap:clamp(10px,2vmin,16px);
margin-top:2px;
}
.judge-actions button{
flex:1;
min-width:0;
}

/* ANCHOR: STAGE_3_UI (Stage 3 — TV-safe; wykorzystuje GAME_HUD; bez nowych "wynalazków"; 0 overflow) */

/* Stage 3 ma używać maksymalnie przestrzeni HUD (nie zmniejszamy stage-card jak w bazie) */
#overlayGame .stage.stage-3{
  align-items:stretch;
  justify-content:stretch;
}
#overlayGame .stage.stage-3 .stage-card{
  display:flex;
  width:100%;
  max-width:none;
  height:100%;
  max-height:none;
  min-height:0;
  align-items:stretch;
  justify-content:flex-start;
  text-align:center;
  overflow:hidden;
  padding:clamp(14px,2.2vmin,22px);
  gap:clamp(10px,2vmin,16px);
}

/* Układ: prezenter u góry (jak w Stage 2), reszta wypełnia kartę */
#overlayGame .stage3-wrap{
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:stretch;
  justify-content:flex-start;
  gap:clamp(10px,2vmin,16px);
}
#overlayGame .stage3-head{
  flex:0 0 auto;
  display:flex;
  justify-content:center;
  align-items:flex-start;
}

/* PRESENTER_PILL w Stage 3 — używamy tego samego komponentu co w Stage 2 (kwadratowy pill),
   ale skalujemy fazami, żeby zawsze mieścił się z timerem/hasłem w HUD. */
#overlayGame .stage.stage-3 .stage2-presenter{
  position:relative;
  margin:0;
  width:min(34vmin, 300px, 100%);
  aspect-ratio:1 / 1;
  display:grid;
  place-items:center;
  padding:clamp(6px,1.2vmin,10px);
  flex:0 0 auto;
  min-height:0;
}
#overlayGame .stage.stage-3 .stage3-wrap[data-phase="word"] .stage2-presenter{width:min(28vmin, 260px, 100%);}
#overlayGame .stage.stage-3 .stage3-wrap[data-phase="act"]  .stage2-presenter{width:min(22vmin, 210px, 100%);}

#overlayGame .stage.stage-3 .stage2-presenter .player-pill.presenter-pill{
  /* [PH] Stage 3: GRID (emoji + nazwa) w stałym kwadracie — bez ucinki nazwy */
  display:grid;
  grid-template-columns:1fr;
  grid-template-rows:1fr auto;

  width:100%;
  height:100%;
  max-width:none;
  max-height:none;
  margin:0;
  align-self:stretch;
  justify-self:stretch;
}
#overlayGame .stage.stage-3 .stage2-presenter .player-pill.presenter-pill .pp-emoji{
  font-size:clamp(4.8rem, 16vmin, 8.6rem);
}
#overlayGame .stage.stage-3 .stage2-presenter .player-pill.presenter-pill .pp-name{
  font-size:clamp(1.05rem,3.2vmin,1.6rem);
}

/* w fazie WORD: licznik trochę mniejszy, żeby nie wypchnął hasła */
#overlayGame .stage3-wrap[data-phase="word"] .stage3-count{font-size:clamp(2.4rem,12vmin,6.8rem);}
#overlayGame .stage3-main{
  flex:1 1 auto;
  min-height:0;
  width:100%;
  position:relative;
  border-radius:clamp(16px,2.2vmin,24px);
  /* [PH][S3] baza: stała ramka jak w Stage 1 (progress tylko ją pokrywa) */
  background:rgba(0,0,0,.18);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.05);

  display:grid;
  grid-template-rows:auto 1fr auto;
  align-items:stretch;
  justify-items:center;
  text-align:center;
  padding-block:clamp(2px,1vmin,10px);
}

/* [PH][S3] STAGE3_BORDER_PROGRESS (wariant A — jak w Stage 1: ramka bazowa + progress ją pokrywa) */
#overlayGame .stage3-main::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  pointer-events:none;
  opacity:0;
  transition:opacity .18s ease;

  /* Minimalistyczny progress: cienka ramka, bez "koła" w środku */
  --bw:clamp(2px,.35vmin,3px);
  /* start od godziny 12 (0deg) */
  padding:var(--bw);
  background:conic-gradient(from 0deg,
    var(--accent2) 0turn,
    var(--accent) calc(var(--p,0) * 1turn),
    transparent calc(var(--p,0) * 1turn),
    transparent 1turn
  );

  /* Zostawiamy tylko obwódkę (content-box wycięty) */
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
          mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
          mask-composite:exclude;
}
#overlayGame .stage3-main.is-advancing::before{opacity:1}

/* (legacy) jeżeli gdzieś został svg progress — chowamy */
#overlayGame .stage3-main .s3-pb{display:none !important;}

/* szanuj motion-off */
body.motion-off #overlayGame .stage3-main.pb-run .s3-pb-path{animation:none;stroke-dashoffset:0}

#overlayGame .stage3-top{
  display:inline-block;
  width:auto;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding-bottom:clamp(10px,2vmin,16px);
}
#overlayGame .stage3-mid{
  display:inline-block;
  width:auto;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:clamp(10px,2vmin,16px);
}
#overlayGame .stage3-bot{
  display:inline-block;
  width:auto;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  gap:clamp(8px,1.6vmin,12px);
  padding-top:clamp(10px,2vmin,16px);
}

/* gdy top/bottom puste, nie dorzucaj sztucznej przerwy */
#overlayGame .stage3-top:empty{padding-bottom:0}
#overlayGame .stage3-bot:empty{padding-top:0}

/* Teksty (spójne z PartyHUB) */
#overlayGame .stage3-msg{
  font-weight:1000;
  letter-spacing:1px;
  text-transform:uppercase;
  font-size:clamp(1.05rem,3.1vmin,1.55rem);
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 0 14px rgba(233,30,99,.18));
}
#overlayGame .stage3-msg-lg{
  font-size:clamp(1.35rem,4.2vmin,2.25rem);
}
#overlayGame .stage3-sub{
  max-width:min(980px,94vw);
  font-weight:850;
  letter-spacing:.35px;
  font-size:clamp(1rem,2.8vmin,1.28rem);
  color:rgba(255,255,255,.84);
  opacity:.95;
}
#overlayGame .stage3-pname{color:#fff}

/* COUNT / TIMER — skaluje się responsywnie i nigdy nie wyjdzie poza kartę */
#overlayGame .stage3-count,
#overlayGame .stage3-timer{
  max-width:100%;
  font-weight:1000;
  letter-spacing:1px;
  font-variant-numeric:tabular-nums;
  line-height:1;
  font-size:clamp(3.2rem,18vmin,10rem);
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 10px 28px rgba(0,0,0,.55));
}

/* Box hasła — stały podział: HASŁO (120px) + KATEGORIA (53px) */
#overlayGame .stage3-wordbox{
  width:min(1120px,100%);
  max-width:100%;
  overflow:hidden;
  padding:0;
  height:173px; /* 120 + 53 */
  border-radius:clamp(18px,2.6vmin,26px);
  border:1px solid rgba(255,255,255,.14);
  background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(0,0,0,.24));
  box-shadow:0 16px 32px rgba(0,0,0,.45);
  backdrop-filter:blur(8px);
  -webkit-backdrop-filter:blur(8px);
  display:flex;
  flex-direction:column;
}
#overlayGame .stage3-wordArea{
  height:120px;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0 clamp(14px,2.6vmin,22px);
  overflow:hidden;
}
#overlayGame .stage3-catArea{
  height:53px;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0 clamp(14px,2.6vmin,22px);
  overflow:hidden;
}
#overlayGame .stage3-word{
  font-weight:1000;
  letter-spacing:.35px;
  text-transform:uppercase;
  font-size:clamp(4.2rem,13.4vmin,9.0rem); /* baza wysoka, JS zmniejszy gdy trzeba */
  max-width:100%;
  margin:0;
  display:block;
  width:100%;
  text-align:center;
  line-height:1.02;
  /* pozwól na łamanie w razie potrzeby, ale bez rozpychania */
  white-space:normal;
  word-break:break-word;
}
#overlayGame .stage3-cat{
  margin:0;
  display:inline-block;
  width:auto;
  text-align:center;
  font-weight:1000;
  letter-spacing:1.6px;
  text-transform:uppercase;
  font-size:clamp(.85rem,2.4vmin,1.1rem);
  color:rgba(255,255,255,.72);
}

/* Mobile / niska wysokość: timer trochę mniejszy */
@media (max-height: 720px){
  #overlayGame .stage3-count,
  #overlayGame .stage3-timer{font-size:clamp(2.8rem,16vmin,8.6rem)}
}



/* --- Stage 3 overrides (requested): stałe wymiary + refresh obok wordbox + READY START + większy timer w ACT --- */

/* Stage3_HEAD zawsze 320px */
#overlayGame .stage3-head{
  height:320px;
  flex:0 0 320px;
}

/* PRESENTER_PILL zawsze 300×300 (w 3A/3B/3C/3D) */
#overlayGame .stage.stage-3 .stage2-presenter{
  width:300px;
  height:300px;
  flex:0 0 300px;
  aspect-ratio:auto;
  padding:0;
  margin:0;
}
#overlayGame .stage.stage-3 .stage2-presenter .player-pill.presenter-pill{
  /* [PH] Stage 3: GRID (emoji + nazwa) w stałym kwadracie — bez ucinki nazwy */
  display:grid;
  grid-template-columns:1fr;
  grid-template-rows:1fr auto;

  width:100%;
  height:100%;
  max-width:none;
  max-height:none;
  margin:0;
  align-self:stretch;
  justify-self:stretch;
}

/* [PH][S3] Niezależnie od fazy (ready/eyes/word/act/verdict): PRESENTER_PILL = 300×300 */
#overlayGame .stage.stage-3 .stage3-wrap[data-phase] .stage2-presenter{
  width:300px;
  height:300px;
  flex:0 0 300px;
}

/* Word row: wordbox wycentrowany względem karty prezentera + kwadratowy refresh obok */
#overlayGame .stage3-wordrow{
  display:inline-block;
  width:auto;
  display:flex;
  justify-content:center; /* grupa wycentrowana w HUD */
  align-items:stretch;    /* refresh = wysokość wordboxa */
  gap:clamp(10px,2vmin,16px);
}

/* [PH][S3_WORDROW] Stabilne centrowanie wordboxa (nie "ucieka" gdy refresh znika):
   - rezerwujemy po bokach symetryczne miejsce (padding)
   - refresh jest pozycjonowany absolutnie w prawej "kieszeni"
   Dzięki temu STAGE3_WORD jest zawsze idealnie w środku STAGE3_MAIN.
*/
#overlayGame .stage3-wordrow.has-refresh{
  /* [PH][S3_WORDROW] Stabilne centrowanie: 3 kolumny (slot / wordbox / slot)
     - lewy slot = pusty (symetria)
     - prawy slot = refresh (lub ukryty, ale miejsce zostaje)
     Dzięki temu STAGE3_WORD jest zawsze idealnie w środku STAGE3_MAIN,
     a przycisk jest tuż obok (nie "ucieka" na prawą krawędź HUD).
  */
  /* [PH][S3_REFRESH] Docelowy rozmiar przycisku refresh: 176×176 */
  --s3slot:176px;
  --s3gap:clamp(10px,2vmin,16px);
  display:grid;
  grid-template-columns: var(--s3slot) minmax(0, 1120px) var(--s3slot);
  column-gap: var(--s3gap);
  align-items:center;
  justify-content:center;
}
#overlayGame .stage3-refresh-slot{width:var(--s3slot);height:var(--s3slot)}
#overlayGame .stage3-wordrow.has-refresh .stage3-wordbox{
  display:inline-block;
  width:auto;
  max-width:1120px;
  min-width:0;
}
#overlayGame .stage3-wordrow.has-refresh .stage3-refresh{
  width:var(--s3slot);
  height:var(--s3slot);
}

/* wordbox ma się skalować, ale trzyma max 980px */
#overlayGame .stage3-wordrow .stage3-wordbox{
  flex:1 1 1120px;
  max-width:1120px;
  min-width:0;
}

/* refresh button (kwadrat) */
#overlayGame .stage3-refresh{
  flex:0 0 auto;
  /* [PH][S3_REFRESH] Kwadrat ma obejmować padding/border → idealne centrowanie wordboxa */
  box-sizing:border-box;
  aspect-ratio:1/1;
  overflow:hidden;
  border-radius:clamp(18px,2.6vmin,26px);
  border:1px solid rgba(255,255,255,.14);
  background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(0,0,0,.24));
  box-shadow:0 16px 32px rgba(0,0,0,.45);
  backdrop-filter:blur(8px);
  -webkit-backdrop-filter:blur(8px);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:clamp(6px,1.2vmin,10px);
  padding:clamp(8px,1.6vmin,12px);
  cursor:pointer;
}
#overlayGame .stage3-refresh:hover{filter:brightness(1.08)}
#overlayGame .stage3-refresh:active{transform:scale(.98)}

/* gdy refreshy się skończą — ukryj przycisk, ale zostaw miejsce (STAGE3_WORD nie zmienia szerokości) */
#overlayGame .stage3-refresh.is-hidden{visibility:hidden;pointer-events:none;transform:none}

/* 3-liniowy układ w przycisku refresh */
#overlayGame .stage3-refresh .s3r-top{
  font-weight:1000;
  letter-spacing:.6px;
  font-size:clamp(.95rem,2.4vmin,1.15rem);
  color:rgba(255,255,255,.78);
}
#overlayGame .stage3-refresh .s3r-ico{font-size:clamp(1.8rem,5.4vmin,2.9rem);line-height:1}
#overlayGame .stage3-refresh .s3r-bot{
  font-weight:950;
  letter-spacing:.4px;
  font-size:clamp(.9rem,2.2vmin,1.05rem);
  color:rgba(255,255,255,.78);
  white-space:nowrap;
}
#overlayGame .stage3-refresh .s3r-num{
  font-weight:1000;
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

/* Kategoria: (wartość) */
#overlayGame .stage3-cat{
  /* [PH][S3_CAT] Kategoria w dolnym wierszu wordboxa */
  margin-top:0;
  padding-top:clamp(8px,1.4vmin,12px);
  font-weight:900;
  letter-spacing:.6px;
  text-transform:none;
  font-size:clamp(.95rem,2.4vmin,1.15rem);
  color:rgba(255,255,255,.82);
  display:inline-block;
  width:auto;
  justify-self:stretch;
  text-align:center;

  display:flex;
  gap:.5ch;
  justify-content:center;
  align-items:baseline;

  align-self:end;
}
#overlayGame .stage3-cat-label{opacity:.75;font-weight:850}
#overlayGame .stage3-cat-val{
  font-weight:1000;
  letter-spacing:1.2px;
  text-transform:uppercase;
  /* motyw gry */
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 0 12px rgba(233,30,99,.14));
}

/* READY (3C): większy tekst + większy odstęp, mniej "pustki" pod kartą prezentera */
#overlayGame .stage3-wrap[data-phase="ready"]{
  gap:clamp(6px,1.4vmin,10px); /* mniejszy odstęp head↔main */
}
#overlayGame .stage3-wrap[data-phase="ready"] .stage3-top{
  padding-bottom:clamp(24px,4.8vmin,44px); /* większy odstęp tekst ↔ START */
}
#overlayGame .stage3-wrap[data-phase="ready"] .stage3-msg{
  font-size:clamp(1.55rem,4.8vmin,2.55rem); /* JESZCZE większy */
}

/* [PH][S3_READY] Szerszy START: pozwól środkowi rozciągnąć się na pełną szerokość karty */
#overlayGame .stage3-wrap[data-phase="ready"] .stage3-mid{
  width:100%;
  max-width:min(980px,100%);
}
#overlayGame .stage3-start-btn{
  width:min(860px,100%);
  padding:clamp(18px,3.2vmin,28px) clamp(22px,4.2vmin,44px);
  font-size:clamp(1.7rem,4.8vmin,2.5rem);
  border-radius:clamp(18px,2.8vmin,26px);
  margin-top:0; /* odstęp kontroluje gap w .stage3-main */
}
/* ACT (3D): podpis nad licznikiem */
#overlayGame .stage3-actlabel{
  font-weight:1000;
  letter-spacing:1px;
  text-transform:uppercase;
  font-size:clamp(1.25rem,3.6vmin,1.95rem);
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 0 14px rgba(233,30,99,.18));
}

/* ACT (3D): większy timer */
#overlayGame .stage3-wrap[data-phase="act"] .stage3-timer{
  font-size:clamp(5.2rem,26vmin,14rem);
}

/* ACT (3D): podpowiedzi pod timerem */
#overlayGame .stage3-hints{
  width:min(980px,100%);
  margin:0 auto;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-wrap:wrap;
  gap:clamp(10px,1.9vmin,14px);
  padding-top:clamp(10px,2.0vmin,18px);
}
#overlayGame .stage3-hint{
  display:flex;
  align-items:baseline;
  gap:.6ch;
  padding:clamp(10px,1.9vmin,14px) clamp(14px,2.6vmin,20px);
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(0,0,0,.22));
  box-shadow:0 10px 22px rgba(0,0,0,.35);
  backdrop-filter:blur(8px);
  -webkit-backdrop-filter:blur(8px);
  color:rgba(255,255,255,.78);
  font-weight:900;
  letter-spacing:.4px;
  font-size:clamp(1.05rem,2.8vmin,1.35rem);
}
#overlayGame .stage3-hint-label{opacity:.75;}
#overlayGame .stage3-hint-val{font-weight:1000;color:rgba(255,255,255,.92)}
#overlayGame .stage3-hint-val.is-accent{
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 0 12px rgba(233,30,99,.14));
}
@media (max-height: 720px){
  #overlayGame .stage3-wrap[data-phase="act"] .stage3-timer{
    font-size:clamp(4.6rem,22vmin,12rem);
  }
}




/* --- Stage 3E (VERDYKT): ZGADLI / NIE ZGADLI --- */
#overlayGame .stage3-wrap[data-phase="verdict"] .stage3-msg{
  font-size:clamp(1.35rem,4.2vmin,2.2rem);
}

/* [PH][S3_VERDICT] Szersze TAK/NIE: środek na 100% */
#overlayGame .stage3-wrap[data-phase="verdict"] .stage3-mid{
  width:100%;
  max-width:min(980px,100%);
}

#overlayGame .stage3-verdict-row{
  width:min(920px,100%);
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:clamp(10px,2vmin,16px);
  margin-top:clamp(10px,2vmin,16px);
}
#overlayGame .stage3-verdict-btn{
  display:inline-block;
  width:auto;
  min-height:clamp(54px,9vmin,88px);
  padding:clamp(12px,2.4vmin,18px) clamp(14px,3vmin,22px);
  font-size:clamp(1.15rem,3.4vmin,1.75rem);
  border-radius:clamp(16px,2.2vmin,22px);
  font-weight:1000;
  letter-spacing:.6px;
  text-transform:uppercase;
}
@media (max-width: 560px){
  #overlayGame .stage3-verdict-row{grid-template-columns:1fr;}
}


/* =========================================================
   STAGE 4 — Rozliczenie (layout jak mockup „ZGADLI”)
   ========================================================= */
#overlayGame .stage.stage-4{
  align-items:stretch;
  justify-content:stretch;
}
#overlayGame .stage.stage-4 .stage-card{
  display:flex;
  width:100%;
  max-width:none;
  height:100%;
  max-height:none;
  min-height:0;
  align-items:stretch;
  justify-content:flex-start;
  overflow:hidden;
  padding:clamp(14px,2.2vmin,22px);
}

/* Layout: nagłówek → grid graczy (scroll jeśli potrzeba) → panel akcji */
#overlayGame .stage4-wrap{
  width:100%;
  height:100%;
  min-height:0;
  display:flex;
  flex-direction:column;
  gap:clamp(10px,2vmin,16px);
}
#overlayGame .stage4-head{
  display:inline-block;
  width:auto;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
  text-align:center;
  gap:clamp(6px,1.4vmin,10px);
}
#overlayGame .stage4-gridwrap{
  flex:1;
  min-height:0;
  overflow:auto;
  padding-bottom:clamp(6px,1.2vmin,10px);
}
#overlayGame .stage4-grid{
  display:inline-block;
  width:auto;
  max-width:min(1500px, 100%);
  margin-inline:auto;
  display:grid;
  gap:clamp(10px,2vmin,14px);
  grid-template-columns:repeat(2, minmax(0, 1fr));
}
@media (min-width: 780px){
  #overlayGame .stage4-grid{ grid-template-columns:repeat(3, minmax(0, 1fr)); }
}
@media (min-width: 1180px){
  #overlayGame .stage4-grid{ grid-template-columns:repeat(4, minmax(0, 1fr)); }
}
@media (max-width: 560px){
  #overlayGame .stage4-grid{ grid-template-columns:1fr; }
}

/* Panel akcji (jak na mockup): toggle bar + hint + duży save */
#overlayGame .stage4-bottom{
  display:inline-block;
  width:auto;
  padding:clamp(12px,2.2vmin,18px);
  border-top:1px solid rgba(255,255,255,.10);
  background:linear-gradient(180deg, rgba(0,0,0,.14), rgba(0,0,0,.08));
  border-radius:clamp(14px,2vmin,18px);
}

#overlayGame .stage4-toggle{
  display:inline-block;
  width:auto;
  max-width:min(1500px, 100%);
  margin-inline:auto;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:clamp(10px,2vmin,14px);
  border-radius:clamp(14px,2vmin,18px);
  border:1px solid rgba(255,255,255,.14);
  background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(0,0,0,.20));
}
#overlayGame .stage4-toggle-plus{
  display:inline-grid;
  place-items:center;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
  margin-right:8px;
  font-weight:1000;
}
#overlayGame .stage4-toggle-name{
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 0 10px rgba(0,0,0,.22));
}
#overlayGame .stage4-toggle-label{
  font-weight:950;
  letter-spacing:.6px;
  text-transform:uppercase;
  font-size:clamp(.95rem,2.6vmin,1.15rem);
  color:rgba(255,255,255,.86);
}

#overlayGame .stage4-hint{
  display:inline-block;
  width:auto;
  max-width:min(1500px, 100%);
  margin-inline:auto;
  padding-top:clamp(10px,2vmin,14px);
  text-align:center;
  font-weight:900;
  letter-spacing:.25px;
  font-size:clamp(.95rem,2.6vmin,1.15rem);
  color:rgba(255,255,255,.78);
  opacity:.88;
}
#overlayGame .stage4-actions{
  display:inline-block;
  width:auto;
  max-width:min(1500px, 100%);
  margin-inline:auto;
  position:relative;
  display:flex;
  justify-content:center;
  align-items:center;
  padding-top:clamp(10px,2vmin,16px);
}
#overlayGame .stage4-save{ min-width:min(420px, 92vw); }
#overlayGame .stage4-back{ position:absolute; left:0; }

@media (max-width: 720px){
  #overlayGame .stage4-actions{ position:static; flex-wrap:wrap; gap:12px; }
  #overlayGame .stage4-back{ position:static; order:2; width:min(420px, 92vw); }
  #overlayGame .stage4-save{ order:1; width:min(420px, 92vw); }
}

/* Kafle wyboru zgadującego */
#overlayGame .stage4-pick .pp-name{ color:#fff; }
#overlayGame .stage4-pick .pp-score .pp-score-num{
  font-size:clamp(1.25rem,3.6vmin,1.95rem);
}
#overlayGame .stage4-pick{
  cursor:pointer;
  position:relative;
  isolation:isolate;
  border:1px solid rgba(255,255,255,.14);
  background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(0,0,0,.22));
  box-shadow:0 14px 26px rgba(0,0,0,.35);
  transition:transform .12s ease, border-color .12s ease, box-shadow .12s ease;
  text-align:left;
}
#overlayGame .stage4-pick:hover{ transform:translateY(-1px); border-color:rgba(255,255,255,.22); box-shadow:0 18px 34px rgba(0,0,0,.42); }
#overlayGame .stage4-pick:focus-visible{ outline:none; border-color:rgba(255,255,255,.30); box-shadow:0 18px 34px rgba(0,0,0,.42), 0 0 0 3px rgba(255,255,255,.18); }
#overlayGame .stage4-pick.is-selected:focus-visible{ box-shadow:0 18px 40px rgba(0,0,0,.55), 0 0 0 3px rgba(233,30,99,.22), 0 0 0 5px rgba(255,255,255,.10); }
#overlayGame .stage4-pick.is-selected{
  border-color:rgba(233,30,99,.55);
  box-shadow:0 18px 40px rgba(0,0,0,.55), 0 0 0 3px rgba(233,30,99,.22);
  filter:brightness(1.05);
}
#overlayGame .stage4-pick.is-selected::after{
  content:"✓";
  position:absolute;
  top:clamp(10px,1.8vmin,14px);
  left:clamp(10px,1.8vmin,14px);
  width:clamp(30px,5vmin,40px);
  height:clamp(30px,5vmin,40px);
  display:grid;
  place-items:center;
  border-radius:999px;
  font-weight:1000;
  letter-spacing:1px;
  text-transform:uppercase;
  font-size:clamp(.95rem,2.8vmin,1.25rem);
  color:#fff;
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  border:1px solid rgba(255,255,255,.12);
  box-shadow:0 10px 22px rgba(0,0,0,.45);
  pointer-events:none;
  z-index:5;
}

/* [PH][S4] NIE ZGADLI — centralny komunikat */
#overlayGame .stage4-gridwrap.is-none{
  display:grid;
  place-items:center;
  overflow:hidden;
}
#overlayGame .s4-none-guessed{
  display:inline-block;
  width:auto;
  display:grid;
  place-items:center;
  gap:clamp(6px,1.4vh,14px);
  padding:clamp(18px,3.2vh,36px);
  text-align:center;
}
#overlayGame .s4-none-title{
  font-weight:1000;
  letter-spacing:1px;
  text-transform:uppercase;
  color:rgba(255,255,255,.92);
  font-size:clamp(18px,3.4vw,34px);
}
#overlayGame .s4-none-word{
  font-weight:850;
  letter-spacing:.5px;
  text-transform:none;
  color:rgba(255,255,255,.78);
  font-size:clamp(14px,2.2vw,22px);
}
#overlayGame .s4-none-wordval{
  font-weight:1000;
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
#overlayGame .stage4-empty{ opacity:.75; text-align:center; padding:18px; }

/* =========================
   ANCHOR: STAGE5_SUMMARY
   Podsumowanie rundy / gry
   ========================= */
#overlayGame .stage.stage-5{
  align-items:stretch;
  justify-content:stretch;
}
#overlayGame .stage.stage-5 .stage-card{
  display:flex;
  width:100%;
  max-width:none;
  height:100%;
  max-height:none;
  min-height:0;
  align-items:stretch;
  justify-content:flex-start;
  overflow:hidden;
  padding:clamp(10px,2.2vmin,18px);
}
#overlayGame .stage5-wrap{
  width:100%;
  height:100%;
  min-height:0;
  display:flex;
  flex-direction:column;
  gap:clamp(12px,2.4vmin,18px);
}
#overlayGame .stage5-head{
  display:inline-block;
  width:auto;
  text-align:center;
  display:flex;
  flex-direction:column;
  gap:clamp(6px,1.2vmin,10px);
  padding-top:clamp(4px,1vmin,10px);
}
#overlayGame .stage5-title{
  font-weight:1000;
  letter-spacing:1px;
  text-transform:uppercase;
  color:rgba(255,255,255,.94);
  font-size:clamp(18px,3.4vw,34px);
}
#overlayGame .stage5-sub{
  font-weight:850;
  letter-spacing:.35px;
  color:rgba(255,255,255,.78);
  font-size:clamp(13px,2.0vw,18px);
}
#overlayGame .stage5-leader{
  font-weight:1000;
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

#overlayGame .stage5-list{
  width:100%;
  max-width:min(1100px, 100%);
  margin-inline:auto;

  flex:1 1 auto;
  min-height:0;
  display:flex;
  flex-direction:column;
  gap:clamp(10px,2vmin,14px);
  padding:clamp(6px,1.2vmin,10px);
  overflow:auto;
  border-radius:clamp(14px,2vmin,18px);
  background:rgba(0,0,0,.12);
  border:1px solid rgba(255,255,255,.08);
}

/* [PH][S5] Układ pozycji: miejsce (#) POZA kartą z lewej, karta wycentrowana względem STAGE5_LIST
   Grid 3 kolumny: (miejsce | karta | spacer) -> spacer symetryczny, więc karta nie "ucieka" w prawo. */
#overlayGame .stage5-item{
  --s5PlaceW:clamp(46px,7.2vmin,70px);
  --s5Gap:clamp(10px,2vmin,14px);
  width:100%;

  display:grid;
  /* #x ma być DOSŁOWNIE z lewej strony karty, a karta wycentrowana względem STAGE5_LIST:
     centrowanie całego bloku (miejsce | karta | spacer) wewnątrz pełnej szerokości. */
  grid-template-columns:
    var(--s5PlaceW)
    min(980px, calc(100% - (2 * var(--s5PlaceW)) - (2 * var(--s5Gap))))
    var(--s5PlaceW);
  align-items:center;
  gap:var(--s5Gap);
  justify-content:center;
}
#overlayGame .stage5-place{
  width: 50px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  letter-spacing:.5px;
  font-size:clamp(42px, 4.6vmin, 48px);
  color:rgba(255,255,255,.72);
  user-select:none;
}
#overlayGame .stage5-place--spacer{ visibility:hidden; }

/* Podium: lekkie podbicie koloru miejsca (1/2/3) */
#overlayGame .stage5-place.stage5-p1{ color:#ffcf5a; }
#overlayGame .stage5-place.stage5-p2{ color:#e6e9f0; }
#overlayGame .stage5-place.stage5-p3{ color:#c06a22; }

#overlayGame .stage5-row.player-pill{
  /* Stage 5: kafelki mają IDENTYCZNĄ szerokość (nie zależy od treści) */
  width:100%;
  max-width:none;
  flex:0 0 auto;
  height:auto;
  min-height:clamp(92px,14vmin,132px);
  margin-inline:0;
  justify-self:center;

  display:flex;
  align-items:center;
  justify-content:space-between;

  /* Zmiennie pomocnicze (spacing) */
  --s5Pad:clamp(10px,2.2vmin,16px);
  --s5Gap:clamp(12px,2.2vmin,18px);
  --s5Av:clamp(54px,9vmin,86px);
  gap:var(--s5Gap);
  padding:var(--s5Pad);
  border-radius:clamp(16px,2.2vmin,22px);
  background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(0,0,0,.22));
  border:1px solid rgba(255,255,255,.14);
  box-shadow:0 14px 26px rgba(0,0,0,.35);
}

/* 1 miejsce (również przy remisie) delikatnie wyróżnione */
#overlayGame .stage5-row.stage5-p1{
  border-color:rgba(233,30,99,.55);
  box-shadow:0 18px 40px rgba(0,0,0,.55), 0 0 0 3px rgba(233,30,99,.18);
}

#overlayGame .stage5-row .pp-emoji{
  position:relative;
  width:var(--s5Av);
  height:var(--s5Av);
  display:grid;
  place-items:center;
  border-radius:999px;
  font-size:clamp(2.1rem,7vmin,3.8rem);
  /* Stage 5: bez tła/ramki za avatarem (emoji bez "kółka") */
  background:transparent;
  border:none;
}
/* (badge #x usunięty — miejsce jest poza kartą po lewej) */

#overlayGame .stage5-row .pp-meta{
  --s5NameH:clamp(44px,7vmin,56px);
  flex:1 1 auto;
  min-width:0;
  display:flex;
  /* Badge jest kotwiczony do .pp-name, meta nie musi być relative */
  position:static;
  overflow:visible;
  /* 1) Pole nazwy wycentrowane w pionie */
  align-items:center;
  justify-content:center;
  padding:0;
}
#overlayGame .stage5-row .pp-name{
  position:relative;
  overflow:visible;
  color:#fff;
  font-weight:1000;
  letter-spacing:.35px;
  font-size:clamp(1.05rem,3.2vmin,1.55rem);
  /* Nazwa wyśrodkowana (badge #x jest NAD tym polem) */
  display:flex;
  justify-content:center;
  align-items:center;
  text-align:center;
  display:inline-block;
  width:auto;
  height:var(--s5NameH);
}

/* Tekst nazwy (ellipsis zostaje, ale na wewnętrznym span) */
#overlayGame .stage5-row .pp-name-txt{
  max-width:100%;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* Podium: 1/2/3 miejsce — kolorowana nazwa */
#overlayGame .stage5-p1 .pp-name-txt{
  /* 2) Bardziej "złote" i wyraźne względem brązu */
  background:linear-gradient(135deg,#fff2b0,#ffb300);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
#overlayGame .stage5-p2 .pp-name-txt{
  background:linear-gradient(135deg,#e6e9f0,#eef1f5);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}
#overlayGame .stage5-p3 .pp-name-txt{
  /* 2) Wyraźniejszy brąz (mniej podobny do złota) */
  background:linear-gradient(135deg,#c06a22,#6f3412);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

#overlayGame .stage5-score{
  flex:0 0 auto;
  /* liczba punktów ma siedzieć "pośrodku" prawej strefy kafelka (nie przy samej krawędzi) */
  min-width:clamp(96px,14vmin,160px);
  width:clamp(96px,14vmin,160px);
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  font-weight:1000;
  letter-spacing:.5px;
  font-size:clamp(1.6rem,4.4vmin,2.4rem);
  background:linear-gradient(135deg,var(--accent2),var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

#overlayGame .stage5-empty{
  opacity:.75;
  text-align:center;
  padding:18px;
}

#overlayGame .stage5-actions{
  display:inline-block;
  width:auto;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:clamp(10px,2.2vmin,16px);
  flex-wrap:wrap;
  padding-bottom:clamp(4px,1vmin,10px);
}

/* ANCHOR: CFG_WINBY_UI */
#overlayModeSettings .winby-options{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}


/* =========================================================
   ANCHOR: STAGE_CARD_FULLWIDTH_FIX
   Visual bugfix (Stage 3/4/5): stage-card znowu 100% szerokości
   ========================================================= */

/* Stage-card w Stage 3/4/5 ma wypełniać cały GAME_HUD (jak dawniej) */
#overlayGame .stage.stage-3 .stage-card,
#overlayGame .stage.stage-4 .stage-card,
#overlayGame .stage.stage-5 .stage-card{
  width:100%;
  height:100%;
  max-width:none;
  max-height:none;
  display:flex;
  flex-direction:column;
  align-items:stretch;
  justify-content:flex-start;
  box-sizing:border-box;
  flex:1 1 auto;
  min-width:0;
  min-height:0;
}

/* Wrapy nie mogą zawężać layoutu (wcześniej width:auto + inline-block powodowały „przyklejenie” do lewej) */
#overlayGame .stage3-wrap,
#overlayGame .stage4-wrap,
#overlayGame .stage5-wrap{
  width:100%;
}
