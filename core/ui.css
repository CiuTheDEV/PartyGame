/* PartyHUB core/ui.css
   Wspólne komponenty UI PartyHUB (overlay, przyciski, karty, scrollbary, ustawienia).
   Motyw kolorystyczny per gra = tokeny w CSS gry (:root). Core używa var() + fallback.

   Zasady: nie twardzimy kolorów gry w core (używamy --brand1/2, --accent/2 itd.).
*/

/* [PH] RESET_BEGIN */
*{box-sizing:border-box}
    html,body{height:100%;margin:0}

    body{
      font-family:var(--font-sans);
      background:var(--bg);
      color:var(--text);
      text-align:center;
      padding:0;
      margin:0;
      display:flex;
      flex-direction:column;
      min-height:100%;
    }
/* [PH] RESET_END */

/* [PH] OVERLAY_BEGIN */
    .overlay{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:clamp(18px,4vmin,42px);
      background:rgba(0,0,0,.68);
      backdrop-filter:blur(6px);
      -webkit-backdrop-filter:blur(6px);
      z-index:1200;
    }
    .overlay.is-visible{display:flex}
    #overlayGame{
      background:transparent;
      backdrop-filter:none;
      -webkit-backdrop-filter:none;
      padding:0;
      z-index:1100;
      align-items:stretch;
      justify-content:stretch;
    }
    #overlayGame.is-visible{display:block}

/* [PH] OVERLAY_END */

/* [PH] COMPONENTS_BEGIN */

    /* ANCHOR: RULES_UI (JAK W TAJNIACY) */
    .rules-container{background:#2a2a2a;border-radius:clamp(15px,2vmin,25px);padding:clamp(20px,4vmin,40px);max-width:min(600px,90vw);width:90%;max-height:85vh;overflow-y:auto;text-align:left}
    .rules-title{font-size:clamp(1.5rem,4vmin,2.5rem);margin-bottom:clamp(15px,3vmin,25px);text-align:center;background:linear-gradient(135deg,var(--brand2,#9b59b6),var(--brand1,#e91e63));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .rules-content{font-size:clamp(0.9rem,2.2vmin,1.1rem);color:#ccc;line-height:1.6}
    .rules-content h3{color:#fff;font-size:clamp(1.1rem,2.5vmin,1.4rem);margin:clamp(15px,2.5vmin,25px) 0 clamp(8px,1.5vmin,12px)}
    .rules-content h3:first-child{margin-top:0}
    .rules-content p{margin:clamp(8px,1.5vmin,12px) 0}
    .rules-content ul{margin:clamp(8px,1.5vmin,12px) 0;padding-left:clamp(20px,3vmin,30px)}
    .rules-content li{margin:clamp(4px,0.8vmin,8px) 0}
    .rules-content .highlight{color:var(--accent);font-weight:bold}
    .rules-container button{display:block;margin:clamp(20px,3vmin,30px) auto 0}


    /* ANCHOR: MODE_SETTINGS_UI (layout z Tajniaków/5s — kontener ustawień) */
    .settings-container{background:#2a2a2a;border-radius:clamp(15px,2vmin,25px);padding:clamp(15px,3vmin,40px);max-width:min(800px,95vw);width:95%;max-height:90vh;overflow-y:auto;overflow-x:hidden}


    /* ANCHOR: SCROLL_SURFACE (wspólne scroll bary w kolorze gry) */
    .scroll-surface{-webkit-overflow-scrolling:touch;scrollbar-width:thin;scrollbar-color:var(--accent) #1a1a1a}
    .scroll-surface::-webkit-scrollbar{width:8px}
    .scroll-surface::-webkit-scrollbar-track{background:#1a1a1a;border-radius:4px}
    .scroll-surface::-webkit-scrollbar-thumb{background:linear-gradient(180deg,var(--accent),var(--accent2));border-radius:4px}
    .scroll-surface::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,var(--accent2),var(--accent))}

    .settings-title{font-size:clamp(1.5rem,4vmin,2.5rem);margin-bottom:2vh;background:linear-gradient(135deg,var(--brand2,#9b59b6),var(--brand1,#e91e63));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .game-settings{background:#1a1a1a;border-radius:clamp(8px,1.2vmin,15px);padding:clamp(12px,2vmin,25px);margin-bottom:2vh;overflow:hidden}
    .game-settings h3{color:var(--accent2);margin:0 0 clamp(10px,1.5vmin,15px);font-size:clamp(1rem,2.2vmin,1.4rem);text-align:left}


    /* ANCHOR: UTIL_LAYOUT (bez inline styles) */
    .section-head{display:flex;justify-content:space-between;align-items:center;gap:10px}
    .settings-container--sm{max-width:500px;width:min(500px,92vw)}
    .game-settings--flush{margin-bottom:0}
    .setting-row--compact{margin:0 0 10px}
    .setting-row--last{margin:0}
    .btn-grow-1{flex:1}
    .btn-grow-2{flex:2}
    .btn-lg{font-size:clamp(1.1rem,2.6vmin,1.35rem)}


    /* ANCHOR: EMOJI_PICKER_UTIL */
    .card-block{margin-bottom:15px}
    .small{font-size:.9rem;color:#888;text-align:center;margin-bottom:8px}
    .emoji-name-label{display:block;font-size:.9rem;color:#888;margin-bottom:8px;text-align:center}
    .emoji-name-input{width:100%;padding:12px;font-size:1.1rem;border-radius:10px;border:2px solid var(--accent2);background:#111;color:#fff;text-align:center;outline:none}
    .emoji-name-input:focus{box-shadow:var(--focusRing)}
    .emoji-picker-actions{display:flex;gap:10px;justify-content:center;margin-top:16px}


    /* ANCHOR: MODE_SETTINGS_CARDS (kafelki jak w Tajniakach) */
    .settings-accordion{display:flex;flex-direction:column;gap:clamp(10px,2vmin,18px)}
    .setting-card{background:linear-gradient(135deg,#1f1f1f,#121212);border:2px solid #333;border-radius:clamp(12px,2vmin,20px);overflow:hidden;transition:border-color .18s, box-shadow .18s}
    .setting-card.open{border-color:var(--accent,#e91e63);box-shadow:0 10px 22px rgba(0,0,0,.45) inset, 0 12px 26px rgba(0,0,0,.35)}
    .setting-head{display:flex;align-items:center;gap:10px;padding:clamp(12px,2.2vmin,18px) clamp(14px,2.6vmin,20px);cursor:pointer;position:relative}
    .setting-title{font-weight:900;color:#fff;text-align:left}
    .setting-sub{flex:1;text-align:right;color:#888;font-size:.95rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-right:26px}
    .setting-arrow{position:absolute;right:clamp(14px,2.6vmin,20px);color:#666;transition:transform .2s}
    .setting-card.open .setting-arrow{transform:rotate(180deg)}
    .setting-body{max-height:0;overflow:hidden;transition:max-height .35s cubic-bezier(0.4,0,0.2,1);border-top:1px solid transparent}
    .setting-card.open .setting-body{max-height:1200px;border-top-color:#222}
    .setting-body-inner{padding:clamp(12px,2vmin,16px);background:rgba(0,0,0,0.12)}
    .setting-actions{margin-top:12px}
    .setting-actions .btn-new{width:100%}

    #playersList{margin:0}
    .setting-row{display:flex;justify-content:space-between;align-items:center;margin:6px 0;padding:clamp(8px,1.2vmin,12px);background:#2a2a2a;border-radius:clamp(6px,1vmin,10px);flex-wrap:wrap;gap:8px;max-width:100%}
    .setting-row label{font-size:clamp(0.85rem,2vmin,1.2rem);color:#ccc}


    /* ANCHOR: ROUND_RANGE_UI (wspólne dla Czas tury i Limit punktów) */
    .setting-row-range{align-items:center;flex-wrap:nowrap}
    .setting-row-range label{flex:0 0 var(--rangeLabelW);text-align:left}
    .range-wrap{flex:1 1 auto;min-width:0;display:flex;flex-direction:column;gap:6px}
    .range-wrap input[type=range]{width:100%;margin:0;padding:0;background:transparent;accent-color:var(--accent)}
    .range-scale{display:flex;justify-content:space-between;gap:0;color:#777;font-weight:800;font-size:.8rem;user-select:none}
    .range-scale span{flex:0 0 auto;min-width:1px;text-align:center;position:relative;cursor:pointer;opacity:.72;transition:opacity .12s,transform .12s,color .12s}
    .range-scale span:hover{opacity:1;color:#bbb;transform:translateY(-1px)}
    .range-scale span.is-active{opacity:1;color:#fff}
    .range-scale span.is-active::after{content:'';position:absolute;left:50%;bottom:-3px;width:100%;height:2px;transform:translateX(-50%);border-radius:2px;background:linear-gradient(90deg,var(--accent2),var(--accent));box-shadow:0 2px 10px color-mix(in srgb, var(--accent) 30%, transparent);opacity:.95}
    .range-scale span:first-child{text-align:left}
    .range-scale span:last-child{text-align:right}
    .range-scale .scale-off{opacity:0;pointer-events:none}
    .range-badge{flex:0 0 var(--rangeBadgeW);min-width:var(--rangeBadgeW);display:flex;align-items:center;justify-content:center;background:#111;border:2px solid var(--accent2);border-radius:12px;padding:8px 10px;font-weight:1000}
    @media(max-width:520px){
      .range-scale{font-size:.72rem}
      .setting-row-range{flex-wrap:wrap}
      .setting-row-range label{flex:1 1 100%}
    }


    /* ANCHOR: CATEGORIES_UI */
    .cat-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
    .cat-chip{padding:10px 10px;border-radius:12px;border:2px solid #333;background:#0f0f0f;color:#ddd;font-weight:700;cursor:pointer;transition:transform .15s,border-color .15s,background .15s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .cat-chip:hover{transform:scale(1.02);border-color:#666;background:#1b1b1b}
    .cat-chip.selected{border-color:var(--accent);background:var(--accentA15);color:#fff}
    .cat-actions{display:flex;gap:10px;justify-content:center;align-items:center;flex-wrap:wrap;margin-top:12px}
    @media(max-width:520px){.cat-grid{grid-template-columns:repeat(2,minmax(0,1fr))}}


    /* ANCHOR: PLAYERS_UI (1:1 z 5 Sekund — lista graczy) */
    .player-row{display:flex;align-items:center;gap:12px;padding:clamp(10px,2vmin,15px);background:#2a2a2a;border-radius:clamp(8px,1vmin,12px);margin:clamp(8px,1.5vmin,12px) 0}
    .player-emoji-display{font-size:2rem;width:50px;height:50px;display:flex;align-items:center;justify-content:center;background:#1a1a1a;border-radius:10px;flex:0 0 auto}
    .player-name-display{flex:1;font-size:1.1rem;font-weight:700;color:#fff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:left}
    .player-edit,.player-del{width:44px;height:44px;padding:0;display:grid;place-items:center;line-height:1;font-size:1.15rem;border-radius:10px;flex:0 0 auto}
    .player-edit{border:2px solid #444;background:#1b1b1b;color:#fff;cursor:pointer}
    .player-del{border:2px solid rgba(255,255,255,.08);background:#e74c3c;color:#fff;cursor:pointer;transition:transform .2s}
    .player-del:hover{background:#c0392b;transform:scale(1.05)}

    .emoji-tabs{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px;justify-content:center;margin-top:12px;width:100%}
    .emoji-tab{width:100%;padding:10px 0;border-radius:14px;border:2px solid #333;background:#111;color:#ddd;font-weight:1000;cursor:pointer;transition:transform .15s,border-color .15s,background .15s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:0}
    .emoji-tab:hover{transform:scale(1.02);border-color:#666;background:#1f1f1f}
    .emoji-tab.selected{border-color:var(--accent);background:var(--accentA15);color:#fff}


    /* ANCHOR: EMOJI_PICKER_LAYOUT (scroll tylko na siatce avatarów) */

    /* ANCHOR: EMOJI_PICKER_FIXED_HEIGHT (stała wysokość kontenera — bez skakania tła przy zmianie kategorii) */
    #emojiPickerOverlay .settings-container{display:flex;flex-direction:column;height:min(90vh,720px);max-height:90vh;overflow:hidden}
    #emojiPickerOverlay .emoji-picker-avatars{flex:1 1 auto;min-height:0;display:flex;flex-direction:column}


    /* ANCHOR: EMOJI_GRID_SCROLLFIX (bez pojawiającego się poziomego scrolla przy hover) */
    .emoji-grid{display:grid;grid-template-columns:repeat(6,minmax(0,1fr));gap:10px;margin-top:12px;flex:1 1 auto;min-height:0;overflow-y:auto;overflow-x:hidden;padding:2px 4px 2px 2px}

    .emoji-btn{width:100%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;font-size:1.8rem;background:#111;border:2px solid #333;border-radius:14px;cursor:pointer;padding:0;transition:transform .15s,background .15s,border-color .15s}
    .emoji-btn:hover{border-color:var(--accent);background:#1f1f1f;transform:scale(1.04)}
    .emoji-btn.selected{border-color:var(--accent2);background:var(--accent2A15)}
    .emoji-btn.disabled,.emoji-btn:disabled{opacity:.28;filter:grayscale(1);cursor:not-allowed;transform:none!important}
    .emoji-btn.disabled:hover,.emoji-btn:disabled:hover{border-color:#333;background:#111;transform:none}


    /* ANCHOR: TOGGLE_SWITCH (slider on/off) */
    .switch{position:relative;display:inline-block;width:56px;height:30px;flex:0 0 auto}
    .switch input{opacity:0;width:0;height:0}
    .slider{position:absolute;inset:0;cursor:pointer;background:#3a3a3a;transition:.2s;border-radius:999px;border:2px solid #555}
    .slider:before{content:"";position:absolute;height:22px;width:22px;left:4px;top:50%;transform:translateY(-50%);background:#fff;transition:.2s;border-radius:50%}
    .switch input:checked + .slider{background:var(--accentA15);border-color:var(--accent)}
    .switch input:checked + .slider:before{transform:translate(26px,-50%);background:var(--accent)}


    /* ANCHOR: BUTTONS (IDENTYCZNE JAK W TAJNIACY/5s) */
    .button-group{display:flex;gap:clamp(10px,2vmin,20px);margin-top:2vh;flex-wrap:wrap;justify-content:center}

    button{padding:clamp(10px,2vh,20px) clamp(20px,3vw,40px);font-size:clamp(1rem,2.5vmin,1.5rem);border:none;border-radius:clamp(8px,1vmin,15px);font-weight:bold;cursor:pointer;transition:transform .14s, box-shadow .14s}
    button:active{transform:scale(.995)}


    /* ANCHOR: BUTTONS_POLISH (subtelna głębia — bez połysku) */
    :where(.btn-new,.btn-primary,.btn-reset,.btn-ghost,.btn-back){border:1px solid var(--btnLine);box-shadow:var(--btnInset),var(--btnShadow)}
    :where(.btn-new,.btn-primary,.btn-reset,.btn-ghost,.btn-back):hover{box-shadow:var(--btnInset),var(--btnShadowHover);transform:translateY(-.5px)}
    :where(.btn-new,.btn-primary,.btn-reset,.btn-ghost,.btn-back):active{transform:translateY(0) scale(.99)}

    .btn-new,.btn-primary{background:var(--accent);color:#fff}


    /* ANCHOR: CONFIRM_BTN_HOVER_BRIGHTNESS (rozjaśnienie o 10% na hover dla przycisków potwierdzających) */
    :where(.btn-new,.btn-primary){transition:transform .14s, box-shadow .14s, filter .14s}
    :where(.btn-new,.btn-primary):hover:not(:disabled){filter:brightness(1.1)}


    /* ANCHOR: BTN_BACK (powrót — nie jest akcją destrukcyjną) */
    .btn-back{background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));color:#fff;border-color:var(--accent2,#9b59b6)}
    .btn-back:hover{background:linear-gradient(180deg,var(--accent2,#9b59b6),var(--accent2,#9b59b6));color:#fff}

    .btn-reset{background:var(--danger);color:#fff;border-color:rgba(255,255,255,.08)}
    .btn-reset:hover{background:var(--dangerHover)}

    .btn-ghost{background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));color:#fff;border-color:rgba(255,255,255,.16)}
    .btn-ghost:hover{background:rgba(255,255,255,.12);border-color:rgba(255,255,255,.22)}

    .btn-close{margin-top:20px;width:100%}
    .btn-sm{padding:10px 18px;font-size:1rem;border-radius:12px}
    .txt-muted{color:#888;font-size:0.9rem}
    .txt-error{color:#e74c3c!important}
    .mt-10{margin-top:10px}
    .mt-8{margin-top:8px}
    .text-center{text-align:center}
    .is-hidden{display:none!important}
    .confirm-msg{font-size:1.1rem;color:#f39c12;margin:0 0 18px;text-align:center}
    button:disabled{opacity:.45;cursor:not-allowed}


    /* ANCHOR: FOCUS_VISIBLE (spójny focus ring PartyHUB) */
    button:focus-visible,
    .mode-header:focus-visible,
    .setting-head:focus-visible,
    .cat-chip:focus-visible,
    .emoji-btn:focus-visible,
    .emoji-tab:focus-visible,
    .home-btn:focus-visible{outline:none;box-shadow:var(--focusRing)}


    /* ANCHOR: TWEMOJI (TEST) */
    img.emoji{height:1em;width:1em;vertical-align:-0.1em}


    /* ANCHOR: A11Y_REDUCED_MOTION (system + ustawienia gry) */
    body.motion-off *{animation:none!important;transition:none!important;scroll-behavior:auto!important}
    @media (prefers-reduced-motion: reduce){
      body:not(.motion-on) *{animation:none!important;transition:none!important;scroll-behavior:auto!important}
    }


    /* ANCHOR: RANGE_THUMB (subtelny, appkowy) */
    input[type=range]::-webkit-slider-runnable-track{height:6px;border-radius:999px;background:rgba(255,255,255,.10)}
    input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:18px;height:18px;border-radius:50%;background:var(--accent);border:2px solid rgba(255,255,255,.22);margin-top:-6px;box-shadow:0 6px 14px rgba(0,0,0,.35)}
    input[type=range]::-moz-range-track{height:6px;border-radius:999px;background:rgba(255,255,255,.10)}
    input[type=range]::-moz-range-thumb{width:18px;height:18px;border-radius:50%;background:var(--accent);border:2px solid rgba(255,255,255,.22);box-shadow:0 6px 14px rgba(0,0,0,.35)}

    @media(max-width:520px){
      .mode-content-inner{flex-direction:column;align-items:stretch}
      .mode-buttons{align-self:center}
      .emoji-grid{grid-template-columns:repeat(5,minmax(0,1fr))}
    }


    /* [PH] COLOR_MIX_SUPPORT (lepsze alphy dla tokenów, bez twardych kolorów w core) */
    @supports (color: color-mix(in srgb, red, transparent)){
      .setting-card.open{border-color:color-mix(in srgb, var(--accent,#e91e63) 55%, transparent)}
      .btn-back{border-color:color-mix(in srgb, var(--accent2,#9b59b6) 75%, transparent)}
      .btn-back:hover{
        background:linear-gradient(180deg,
          color-mix(in srgb, var(--accent2,#9b59b6) 92%, transparent),
          color-mix(in srgb, var(--accent2,#9b59b6) 78%, transparent)
        );
      }
    }

/* [PH] COMPONENTS_END */

.ph-hidden{display:none !important;}


/* [PH] GAME_SHELL_BEGIN
   Wspólne “ramy” gry: ekran, HUD, top/bottom bar (bez stage-specyficznych elementów).
*/
#overlayGame{overflow:hidden}

/* ANCHOR: GAME_SCREEN_LAYOUT */
#overlayGame .game-screen{
  position:relative;
  width:100vw;
  height:100vh;
  display:grid;
  grid-template-rows:var(--barH) minmax(0,1fr) var(--bottomBarH);
  align-items:stretch;
  justify-content:stretch;
  overflow:hidden;
}
#overlayGame .game-screen.bb-off{--bottomBarH:0px}
#overlayGame .game-screen.bb-off .bottom-bar{display:none}

/* ANCHOR: GAME_HUD_LAYOUT */
#overlayGame .game-hud{
  grid-row:2;
  min-height:0;
  overflow:hidden;
  display:flex;
  align-items:stretch;
  justify-content:stretch;
  padding:clamp(10px,2vmin,18px);
}

/* ANCHOR: STAGE_BASE_UI */
#overlayGame .stage{width:100%;height:100%;min-height:0;display:flex;align-items:center;justify-content:center;flex:1}
#overlayGame .stage-card{
  width:min(640px,92vw);
  border-radius:clamp(16px,2.2vmin,24px);
  border:1px solid rgba(255,255,255,.12);
  background:linear-gradient(135deg, rgba(255,255,255,.08), rgba(0,0,0,.12));
  box-shadow:0 18px 34px rgba(0,0,0,.50);
  padding:clamp(16px,2.8vmin,26px);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:clamp(10px,2vmin,16px);
  user-select:none;
  text-align:center;
  overflow:hidden;
}
#overlayGame .stage-title{
  font-weight:1000;
  letter-spacing:1px;
  text-transform:uppercase;
  font-size:clamp(1.6rem,5.2vmin,2.8rem);
  line-height:1.02;
  background:linear-gradient(135deg, var(--accent2), var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 0 16px rgba(0,0,0,.22));
}

/* ANCHOR: TOP_BAR_BASE */
#overlayGame .top-bar{
  grid-row:1;
  height:var(--barH);
  display:flex;
  align-items:center;
  justify-content:flex-end;
  padding:0 var(--barPadX, clamp(12px,2.4vmin,18px));
}
#overlayGame .top-bar-inner{
  width:100%;
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:center;
  gap:clamp(10px,2vmin,16px);
  min-width:0;
}
#overlayGame .top-title{
  grid-column:2;
  justify-self:center;
  align-self:center;
  min-width:0;
  padding:0 clamp(10px,2.2vmin,14px);
  border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:linear-gradient(180deg,rgba(255,255,255,.10),rgba(255,255,255,.06));
  box-shadow:0 10px 18px rgba(0,0,0,.28);
  font-weight:1000;
  letter-spacing:1.6px;
  text-transform:uppercase;
  font-size:clamp(.92rem,2.6vmin,1.25rem);
  line-height:1;
  color:#fff;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
#overlayGame .top-title.is-hidden{display:none!important}

/* ANCHOR: BOTTOM_BAR_BASE */
#overlayGame .bottom-bar{
  grid-row:3;
  height:var(--bottomBarH);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0 var(--barPadX, clamp(12px,2.4vmin,18px));
}

/* ANCHOR: PLAYERS_BAR_BASE */
#overlayGame .players-bar{
  grid-row:3;
  min-height:0;
  padding:clamp(8px,1.8vmin,14px) var(--barPadX, clamp(12px,2.4vmin,18px)) clamp(10px,2.4vmin,18px);
  display:flex;
  align-items:stretch;
  justify-content:center;
  overflow:hidden;
}
#overlayGame .players-bar-inner{
  width:min(980px,94vw);
  height:100%;
  min-height:0;
  margin:0 auto;
  padding:var(--innerPad);
  overflow:hidden;
  box-sizing:border-box;
  --cols:4;
  --rows:2;
  display:grid;
  gap:var(--plGap);
  grid-template-columns:repeat(var(--cols), minmax(0, 1fr));
  grid-template-rows:repeat(var(--rows), minmax(0, 1fr));
  place-content:center;
  align-content:center;
  justify-content:center;
}

/* [PH] PLAYER_PILL_BEGIN */
.player-pill{
  position:relative;
  width:100%;
  height:100%;
  min-width:0;
  min-height:0;
  display:grid;
  grid-template-columns:1fr 1.55fr;
  grid-template-rows:1fr 1fr;
  gap:var(--plGap);
  padding:var(--plPad);
  border-radius:var(--plRadius);
  background:linear-gradient(135deg, rgba(255,255,255,.08), rgba(0,0,0,.18));
  border:2px solid rgba(255,255,255,.10);
  box-shadow:0 14px 28px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.06);
  overflow:hidden;
  transition:transform .16s, box-shadow .16s, border-color .16s, filter .16s;
  transform-style:preserve-3d;
  perspective:900px;
}
.player-pill::before{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index:0;
  background:radial-gradient(120% 120% at 28% 22%, rgba(255,255,255,.06), transparent 62%),
             radial-gradient(140% 140% at 78% 84%, rgba(0,0,0,.18), transparent 64%);
}
.player-pill > *{position:relative;z-index:1;backface-visibility:hidden;-webkit-backface-visibility:hidden}
.player-pill > .pp-order{z-index:3}

.player-pill .pp-emoji{
  grid-column:1;
  grid-row:1 / span 2;
  width:100%;
  height:100%;
  aspect-ratio:auto;
  border-radius:calc(var(--plRadius) - 4px);
  background:transparent;
  border:none;
  display:grid;
  place-items:center;
  font-size:var(--avFontP);
  box-shadow:none;
}
.player-pill .pp-meta{
  grid-column:2;
  grid-row:1 / span 2;
  width:100%;
  min-width:0;
  display:grid;
  grid-template-rows:1fr 1fr;
  gap:var(--plGap);
  padding:0;
  background:none;
  border:none;
  border-radius:0;
  box-shadow:none;
}
.player-pill .pp-name,
.player-pill .pp-score{
  width:100%;
  min-width:0;
  display:grid;
  place-items:center;
  padding:clamp(8px,1.6vmin,12px);
  border-radius:clamp(12px,1.8vmin,16px);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.05);
}
.player-pill .pp-name{
  width:100%;
  min-width:0;
  max-width:100%;
  display:grid;
  place-items:center;
  padding:clamp(8px,1.6vmin,12px);
  border-radius:clamp(12px,1.8vmin,16px);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.05);
  background:rgba(0,0,0,.22);
  font-weight:1000;
  font-size:var(--nameFontP);
  letter-spacing:.6px;
  text-transform:uppercase;
  line-height:1.05;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  text-shadow:0 2px 6px rgba(0,0,0,.55);
}
.player-pill .pp-score{
  background:rgba(0,0,0,.26);
  font-weight:1000;
  font-size:var(--scoreFont);
  letter-spacing:.4px;
  line-height:1;
  color:#fff;
  white-space:nowrap;
  text-shadow:0 2px 6px rgba(0,0,0,.55);
}
.player-pill .pp-score .pp-score-num{
  font-weight:1000;
  font-size:clamp(1.35rem,4.2vmin,2.2rem);
  line-height:1;
  letter-spacing:.2px;
  background:linear-gradient(135deg, var(--accent2), var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  filter:drop-shadow(0 0 14px rgba(0,0,0,.22));
}
.player-pill .pp-emoji,
.player-pill .pp-meta,
.player-pill .pp-name,
.player-pill .pp-score{transition:opacity .18s, transform .18s, filter .18s}

@supports (color: color-mix(in srgb, red, transparent)){
  #overlayGame .stage-card{
    background:linear-gradient(135deg,
      color-mix(in srgb, var(--accent,#e91e63) 14%, transparent),
      color-mix(in srgb, var(--accent2,#9b59b6) 16%, transparent)
    );
  }
  #overlayGame .stage-title{filter:drop-shadow(0 0 16px color-mix(in srgb, var(--accent,#e91e63) 22%, transparent))}
  .player-pill::before{
    background:
      radial-gradient(120% 120% at 28% 22%, color-mix(in srgb, var(--accent,#e91e63) 18%, transparent), transparent 62%),
      radial-gradient(140% 140% at 78% 84%, color-mix(in srgb, var(--accent2,#9b59b6) 16%, transparent), transparent 64%);
  }
}
/* [PH] PLAYER_PILL_END */

/* [PH] GAME_SHELL_END */


/* [PH] TOAST + OFFSCREEN_BEGIN */
.ph-offscreen-ta{position:fixed;left:-9999px;top:-9999px}
.ph-toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);z-index:9999;padding:10px 12px;border-radius:12px;background:rgba(0,0,0,.75);color:#fff;font-size:14px;max-width:min(92vw,520px);text-align:center;pointer-events:none;opacity:0;transition:opacity .2s ease}
.ph-toast.is-on{opacity:1}
/* [PH] TOAST + OFFSCREEN_END */
